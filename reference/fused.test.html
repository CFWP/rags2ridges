<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Test the necessity of fusion — fused.test • rags2ridges</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Test the necessity of fusion — fused.test" />
<meta property="og:description" content="Function for testing the null hypothesis that all population precision
matrices are equal and thus the necessity for the fusion penalty. Note, the
test performed is conditional on the supplied penalties and targets." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rags2ridges</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rags2ridges.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/CFWP/rags2ridges/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Test the necessity of fusion</h1>
    <small class="dont-index">Source: <a href='https://github.com/CFWP/rags2ridges/blob/master/R/rags2ridgesFused.R'><code>R/rags2ridgesFused.R</code></a></small>
    <div class="hidden name"><code>fused.test.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function for testing the null hypothesis that all population precision
matrices are equal and thus the necessity for the fusion penalty. Note, the
test performed is conditional on the supplied penalties and targets.</p>
    </div>

    <pre class="usage"><span class='fu'>fused.test</span><span class='op'>(</span><span class='va'>Ylist</span>, <span class='va'>Tlist</span>, <span class='va'>lambda</span>, n.permutations <span class='op'>=</span> <span class='fl'>100</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Ylist</th>
      <td><p>A <code>list</code> of length \(G\) of observations matrices for
each class.  Variables are assumed to correspond to the columns.</p></td>
    </tr>
    <tr>
      <th>Tlist</th>
      <td><p>A <code>list</code> of target matrices for each class. Should be same
length as <code>Ylist</code>-</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>A non-negative, symmetric \(G\) by \(G\) <code>matrix</code>
giving the ridge and fusion penalties.</p></td>
    </tr>
    <tr>
      <th>n.permutations</th>
      <td><p>The number of permutations to approximate the null
distribution.  Default is 100. Should be increased if sufficient computing
power is available.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Print out extra progress information</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed to <code><a href='ridgeP.fused.html'>ridgeP.fused</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a <code>list</code> values containing the observed test statistic
  and the test statistic under the null distribution.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function computes the observed score statistic \(U_obs\) using the
fused ridge estimator on the given data. Next, the score statistic is
computed a number of times (given by <code>n.permutations</code>) under the
null-hypothesis by effectively permuting the class labels of the data.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Bilgrau, A.E., Peeters, C.F.W., Eriksen, P.S., Boegsted, M., and
  van Wieringen, W.N. (2020).  Targeted Fused Ridge Estimation of Inverse
  Covariance Matrices from Multiple High-Dimensional Data Classes.  Journal
  of Machine Learning Research, 21(26): 1-52.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='ridgeP.fused.html'>ridgeP.fused</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Anders Ellern Bilgrau, Carel F.W. Peeters &lt;carel.peeters@wur.nl&gt;,
  Wessel, N. van Wieringen</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>ns</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>5</span>, <span class='fl'>23</span><span class='op'>)</span>
<span class='va'>Ylist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='createS.html'>createS</a></span><span class='op'>(</span><span class='va'>ns</span>, p <span class='op'>=</span> <span class='fl'>15</span>, topology <span class='op'>=</span> <span class='st'>"banded"</span>, dataset <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># Use the identity target matrix for each class</span>
<span class='va'>Tlist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>ns</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>15</span><span class='op'>)</span>, simplify <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'># Do the test</span>
<span class='va'>lm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>3</span>, <span class='fl'>3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>lm</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>ft</span> <span class='op'>&lt;-</span> <span class='fu'>fused.test</span><span class='op'>(</span><span class='va'>Ylist</span>, <span class='va'>Tlist</span>, lambda <span class='op'>=</span> <span class='va'>lm</span>,
                 n.permutations <span class='op'>=</span> <span class='fl'>500</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>ft</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Score-based permutation test
#&gt; 
#&gt; Null hypothesis: Population precision matrices are equal
#&gt; Alternative:     Population precision matrices are not equal
#&gt; 
#&gt; Observed statistic: U = 206098.963, p-value = 0.01
#&gt; Summary of null distribution obtained by permutation:
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;  122300  146200  155400  156900  164300  220400 </div><div class='input'>
<span class='co'># Summary spits out a bit more information</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ft</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Score-based permutation test
#&gt; 
#&gt; Null hypothesis: Population precision matrices are equal
#&gt; Alternative:     Population precision matrices are not equal
#&gt; 
#&gt; Observed statistic: U = 206098.963, p-value = 0.01
#&gt; Summary of null distribution obtained by permutation:
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;  122300  146200  155400  156900  164300  220400 
#&gt; 
#&gt; The number of extreme observations under the null hypothesis
#&gt; was 5 out of 500 permutations.</div><div class='input'>
<span class='co'># The returned object can alo be plotted via</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>ft</span><span class='op'>)</span>
</div><div class='input'><span class='co'># or via the alias</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ft</span><span class='op'>)</span>
</div><div class='img'><img src='fused.test-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Customization and parameters work a usual:</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>ft</span>, col <span class='op'>=</span> <span class='st'>"steelblue"</span>, main <span class='op'>=</span> <span class='st'>"Null distribution"</span>, add.extra <span class='op'>=</span> <span class='cn'>FALSE</span>,
     xlab <span class='op'>=</span> <span class='st'>"Score statistic"</span>, freq <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='img'><img src='fused.test-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Carel F.W. Peeters, Anders Ellern Bilgrau, Wessel N. van Wieringen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


