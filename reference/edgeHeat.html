<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Visualize (precision) matrix as a heatmap — edgeHeat • rags2ridges</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Visualize (precision) matrix as a heatmap — edgeHeat"><meta property="og:description" content="Function that visualizes a (precision) matrix as a heatmap. May be used to
assess visually the elements of a single (possibly sparsified precision)
matrix. May also be used in assessing the performance of edge selection
techniques."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rags2ridges</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/rags2ridges.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/CFWP/rags2ridges/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Visualize (precision) matrix as a heatmap</h1>
    <small class="dont-index">Source: <a href="https://github.com/CFWP/rags2ridges/blob/master/R/rags2ridges.R" class="external-link"><code>R/rags2ridges.R</code></a></small>
    <div class="hidden name"><code>edgeHeat.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function that visualizes a (precision) matrix as a heatmap. May be used to
assess visually the elements of a single (possibly sparsified precision)
matrix. May also be used in assessing the performance of edge selection
techniques.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">edgeHeat</span><span class="op">(</span></span>
<span>  <span class="va">M</span>,</span>
<span>  lowColor <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>  highColor <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  textsize <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  diag <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  main <span class="op">=</span> <span class="st">""</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-m">M<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>(Possibly sparsified precision) <code>matrix</code>.</p></dd>


<dt id="arg-lowcolor">lowColor<a class="anchor" aria-label="anchor" href="#arg-lowcolor"></a></dt>
<dd><p>A <code>character</code> that determines the color scale in the
negative range.</p></dd>


<dt id="arg-highcolor">highColor<a class="anchor" aria-label="anchor" href="#arg-highcolor"></a></dt>
<dd><p>A <code>character</code> that determines the color scale in the
positive range.</p></dd>


<dt id="arg-textsize">textsize<a class="anchor" aria-label="anchor" href="#arg-textsize"></a></dt>
<dd><p>A <code>numeric</code> scaling the text size of row and column
labels.</p></dd>


<dt id="arg-diag">diag<a class="anchor" aria-label="anchor" href="#arg-diag"></a></dt>
<dd><p>A <code>logical</code> determining if the diagonal elements of the
matrix should be included in the color scaling. This argument is only used
when <code>M</code> is a square <code>matrix</code>.</p></dd>


<dt id="arg-legend">legend<a class="anchor" aria-label="anchor" href="#arg-legend"></a></dt>
<dd><p>A <code>logical</code> indicating whether a color legend should be
included.</p></dd>


<dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>A <code>character</code> giving the main figure title.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function utilizes
<a href="https://cran.r-project.org/package=ggplot2" class="external-link">ggplot2</a> (Wickham, 2009) to
visualize a matrix as a heatmap: a false color plot in which the individual
matrix entries are represented by colors. <code>lowColor</code> determines the
color scale for matrix entries in the negative range. <code>highColor</code>
determines the color scale for matrix entries in the positive range. For the
colors supported by the arguments <code>lowColor</code> and <code>highColor</code>, see
<a href="https://www.nceas.ucsb.edu/sites/default/files/2020-04/colorPaletteCheatsheet.pdf" class="external-link">https://www.nceas.ucsb.edu/sites/default/files/2020-04/colorPaletteCheatsheet.pdf</a>. White entries in
the plot represent the midscale value of 0. One can opt to set the diagonal
entries to the midscale color of white when one is interested in
(heatmapping) the off-diagonal elements only. To achieve this, set
<code>diag = FALSE</code>. Naturally, the <code>diag</code> argument is only used when
the input matrix <code>M</code> is a square matrix.</p>
<p>The intended use of the function is to visualize a, possibly sparsified,
precision matrix as a heatmap. The function may also be used, in a graphical
modeling setting, to assess the performance of edge selection techniques.
However, the function is quite general, in the sense that it can represent
any <code>matrix</code> as a heatmap.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Wickham, H. (2009). ggplot2: elegant graphics for data analysis.
New York: Springer.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="covML.html">covML</a></code>, <code><a href="ridgeP.html">ridgeP</a></code>, <code><a href="sparsify.html">sparsify</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Carel F.W. Peeters &lt;carel.peeters@wur.nl&gt;, Wessel N. van Wieringen</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Obtain some (high-dimensional) data</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">=</span> <span class="fl">25</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">333</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span> <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">Cx</span> <span class="op">&lt;-</span> <span class="fu"><a href="covML.html">covML</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Obtain regularized precision matrix</span></span></span>
<span class="r-in"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="ridgeP.html">ridgeP</a></span><span class="op">(</span><span class="va">Cx</span>, lambda <span class="op">=</span> <span class="fl">10</span>, type <span class="op">=</span> <span class="st">"Alt"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Obtain sparsified partial correlation matrix</span></span></span>
<span class="r-in"><span><span class="va">PC0</span> <span class="op">&lt;-</span> <span class="fu"><a href="sparsify.html">sparsify</a></span><span class="op">(</span><span class="va">P</span>, threshold <span class="op">=</span> <span class="st">"localFDR"</span>, FDRcut <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span><span class="op">$</span><span class="va">sparseParCor</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 1... determine cutoff point</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 2... estimate parameters of null distribution and eta0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 3... compute p-values and estimate empirical PDF/CDF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 4... compute q-values and local fdr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 5... prepare for plotting</span>
<span class="r-plt img"><img src="edgeHeat-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Retained elements:  11 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Corresponding to 3.67 % of possible edges </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Visualize sparsified partial correlation matrix as heatmap</span></span></span>
<span class="r-in"><span><span class="fu">edgeHeat</span><span class="op">(</span><span class="va">PC0</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-plt img"><img src="edgeHeat-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Carel F.W. Peeters, Anders Ellern Bilgrau, Wessel N. van Wieringen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

