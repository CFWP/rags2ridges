<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Visualize (precision) matrix as a heatmap — edgeHeat • rags2ridges</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Visualize (precision) matrix as a heatmap — edgeHeat" />
<meta property="og:description" content="Function that visualizes a (precision) matrix as a heatmap. May be used to
assess visually the elements of a single (possibly sparsified precision)
matrix. May also be used in assessing the performance of edge selection
techniques." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rags2ridges</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rags2ridges.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/CFWP/rags2ridges/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Visualize (precision) matrix as a heatmap</h1>
    <small class="dont-index">Source: <a href='https://github.com/CFWP/rags2ridges/blob/master/R/rags2ridges.R'><code>R/rags2ridges.R</code></a></small>
    <div class="hidden name"><code>edgeHeat.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function that visualizes a (precision) matrix as a heatmap. May be used to
assess visually the elements of a single (possibly sparsified precision)
matrix. May also be used in assessing the performance of edge selection
techniques.</p>
    </div>

    <pre class="usage"><span class='fu'>edgeHeat</span><span class='op'>(</span>
  <span class='va'>M</span>,
  lowColor <span class='op'>=</span> <span class='st'>"blue"</span>,
  highColor <span class='op'>=</span> <span class='st'>"red"</span>,
  textsize <span class='op'>=</span> <span class='fl'>10</span>,
  diag <span class='op'>=</span> <span class='cn'>TRUE</span>,
  legend <span class='op'>=</span> <span class='cn'>TRUE</span>,
  main <span class='op'>=</span> <span class='st'>""</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>M</th>
      <td><p>(Possibly sparsified precision) <code>matrix</code>.</p></td>
    </tr>
    <tr>
      <th>lowColor</th>
      <td><p>A <code>character</code> that determines the color scale in the
negative range.</p></td>
    </tr>
    <tr>
      <th>highColor</th>
      <td><p>A <code>character</code> that determines the color scale in the
positive range.</p></td>
    </tr>
    <tr>
      <th>textsize</th>
      <td><p>A <code>numeric</code> scaling the text size of row and column
labels.</p></td>
    </tr>
    <tr>
      <th>diag</th>
      <td><p>A <code>logical</code> determining if the diagonal elements of the
matrix should be included in the color scaling. This argument is only used
when <code>M</code> is a square <code>matrix</code>.</p></td>
    </tr>
    <tr>
      <th>legend</th>
      <td><p>A <code>logical</code> indicating whether a color legend should be
included.</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>A <code>character</code> giving the main figure title.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function utilizes
<a href='https://cran.r-project.org/package=ggplot2'>ggplot2</a> (Wickham, 2009) to
visualize a matrix as a heatmap: a false color plot in which the individual
matrix entries are represented by colors. <code>lowColor</code> determines the
color scale for matrix entries in the negative range. <code>highColor</code>
determines the color scale for matrix entries in the positive range. For the
colors supported by the arguments <code>lowColor</code> and <code>highColor</code>, see
<a href='https://stat.columbia.edu/~tzheng/files/Rcolor.pdf'>https://stat.columbia.edu/~tzheng/files/Rcolor.pdf</a>. White entries in
the plot represent the midscale value of 0. One can opt to set the diagonal
entries to the midscale color of white when one is interested in
(heatmapping) the off-diagonal elements only. To achieve this, set
<code>diag = FALSE</code>. Naturally, the <code>diag</code> argument is only used when
the input matrix <code>M</code> is a square matrix.</p>
<p>The intended use of the function is to visualize a, possibly sparsified,
precision matrix as a heatmap. The function may also be used, in a graphical
modeling setting, to assess the performance of edge selection techniques.
However, the function is quite general, in the sense that it can represent
any <code>matrix</code> as a heatmap.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Wickham, H. (2009). ggplot2: elegant graphics for data analysis.
New York: Springer.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='covML.html'>covML</a></code>, <code><a href='ridgeP.html'>ridgeP</a></code>, <code><a href='sparsify.html'>sparsify</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Carel F.W. Peeters &lt;cf.peeters@vumc.nl&gt;, Wessel N. van Wieringen</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Obtain some (high-dimensional) data</span>
<span class='va'>p</span> <span class='op'>=</span> <span class='fl'>25</span>
<span class='va'>n</span> <span class='op'>=</span> <span class='fl'>10</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>333</span><span class='op'>)</span>
<span class='va'>X</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>*</span><span class='va'>p</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='va'>n</span>, ncol <span class='op'>=</span> <span class='va'>p</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>25</span><span class='op'>]</span> <span class='op'>=</span> <span class='va'>letters</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>25</span><span class='op'>]</span>
<span class='va'>Cx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='covML.html'>covML</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span>

<span class='co'>## Obtain regularized precision matrix</span>
<span class='va'>P</span> <span class='op'>&lt;-</span> <span class='fu'><a href='ridgeP.html'>ridgeP</a></span><span class='op'>(</span><span class='va'>Cx</span>, lambda <span class='op'>=</span> <span class='fl'>10</span>, type <span class='op'>=</span> <span class='st'>"Alt"</span><span class='op'>)</span>

<span class='co'>## Obtain sparsified partial correlation matrix</span>
<span class='va'>PC0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sparsify.html'>sparsify</a></span><span class='op'>(</span><span class='va'>P</span>, threshold <span class='op'>=</span> <span class='st'>"localFDR"</span>, FDRcut <span class='op'>=</span> <span class='fl'>.8</span><span class='op'>)</span><span class='op'>$</span><span class='va'>sparseParCor</span>
</div><div class='output co'>#&gt; Step 1... determine cutoff point
#&gt; Step 2... estimate parameters of null distribution and eta0
#&gt; Step 3... compute p-values and estimate empirical PDF/CDF
#&gt; Step 4... compute q-values and local fdr
#&gt; Step 5... prepare for plotting</div><div class='img'><img src='edgeHeat-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; - Retained elements:  11 
#&gt; - Corresponding to 3.67 % of possible edges 
#&gt;  </div><div class='input'>
<span class='co'>## Visualize sparsified partial correlation matrix as heatmap</span>
<span class='fu'>edgeHeat</span><span class='op'>(</span><span class='va'>PC0</span><span class='op'>)</span>
</div><div class='img'><img src='edgeHeat-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Carel F.W. Peeters, Anders Ellern Bilgrau, Wessel N. van Wieringen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


