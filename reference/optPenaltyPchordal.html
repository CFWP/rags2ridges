<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Automatic search for penalty parameter of ridge precision estimator with
known chordal support — optPenaltyPchordal • rags2ridges</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Automatic search for penalty parameter of ridge precision estimator with
known chordal support — optPenaltyPchordal"><meta property="og:description" content="Automic search for the optimal ridge penalty parameter for the ridge
estimator of the precision matrix with known chordal support. Optimal in the
sense that it yields the maximum cross-validated likelihood. The search
employs the Brent algorithm as implemented in the
optim function."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rags2ridges</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/rags2ridges.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/CFWP/rags2ridges/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Automatic search for penalty parameter of ridge precision estimator with
known chordal support</h1>
    <small class="dont-index">Source: <a href="https://github.com/CFWP/rags2ridges/blob/HEAD/R/rags2ridgesVariants.r" class="external-link"><code>R/rags2ridgesVariants.r</code></a></small>
    <div class="hidden name"><code>optPenaltyPchordal.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Automic search for the optimal ridge penalty parameter for the ridge
estimator of the precision matrix with known chordal support. Optimal in the
sense that it yields the maximum cross-validated likelihood. The search
employs the Brent algorithm as implemented in the
<code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> function.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">optPenaltyPchordal</span><span class="op">(</span>
  <span class="va">Y</span>,
  <span class="va">lambdaMin</span>,
  <span class="va">lambdaMax</span>,
  lambdaInit <span class="op">=</span> <span class="op">(</span><span class="va">lambdaMin</span> <span class="op">+</span> <span class="va">lambdaMax</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>,
  <span class="va">zeros</span>,
  cliques <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  separators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  target <span class="op">=</span> <span class="fu"><a href="default.target.html">default.target</a></span><span class="op">(</span><span class="fu"><a href="covML.html">covML</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span>,
  type <span class="op">=</span> <span class="st">"Alt"</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>Y</dt>
<dd><p>Data <code>matrix</code>. Variables assumed to be represented by columns.</p></dd>
<dt>lambdaMin</dt>
<dd><p>A <code>numeric</code> giving the minimum value for the penalty
parameter.</p></dd>
<dt>lambdaMax</dt>
<dd><p>A <code>numeric</code> giving the maximum value for the penalty
parameter.</p></dd>
<dt>lambdaInit</dt>
<dd><p>A <code>numeric</code> giving the initial value for the penalty
parameter.</p></dd>
<dt>zeros</dt>
<dd><p>A <code>matrix</code> with indices of entries of the precision matrix
that are constrained to zero. The matrix comprises two columns, each row
corresponding to an entry of the precision matrix. The first column contains
the row indices and the second the column indices. The specified conditional
independence graph implied by the zero-structure of the precision should be
undirected and decomposable. If not, it is symmetrized and triangulated.</p></dd>
<dt>cliques</dt>
<dd><p>A <code>list</code>-object containing the node indices per clique
as obtained from the <code><a href="support4ridgeP.html">support4ridgeP</a></code>-function.</p></dd>
<dt>separators</dt>
<dd><p>A <code>list</code>-object containing the node indices per
separator as obtained from the <code><a href="support4ridgeP.html">support4ridgeP</a></code>-function.</p></dd>
<dt>target</dt>
<dd><p>A target <code>matrix</code> (in precision terms) for Type I ridge
estimators.</p></dd>
<dt>type</dt>
<dd><p>A <code>character</code> indicating the type of ridge estimator to be
used. Must be one of: <code>Alt</code>, <code>ArchI</code>, <code>ArchII</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>numeric</code> with the LOOCV optimal choice for the ridge penalty
parameter.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>See the function <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> for details on the
implementation of the Brent algorithm.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Miok, V., Wilting, S.M., Van Wieringen, W.N. (2016), "Ridge
estimation of the VAR(1) model and its time series chain graph from
multivariate time-course omics data", <em>Biometrical Journal</em>, 59(1),
172-191.</p>
<p>Van Wieringen, W.N. and Peeters, C.F.W. (2016), "Ridge Estimation of Inverse
Covariance Matrices from High-Dimensional Data", <em>Computational
Statistics and Data Analysis</em>, 103, 284-303.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ridgePchordal.html">ridgePchordal</a></code>,
<code><a href="ridgeP.html">ridgeP</a></code>,
<code><a href="optPenalty.aLOOCV.html">optPenalty.aLOOCV</a></code>,
<code><a href="optPenalty.kCV.html">optPenalty.kCV</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Wessel N. van Wieringen.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co"># generate data</span></span>
<span class="r-in"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span class="r-in"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">333</span><span class="op">)</span></span>
<span class="r-in"><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># define zero structure</span></span>
<span class="r-in"><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="covML.html">covML</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span>
<span class="r-in"><span class="va">S</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span class="r-in"><span class="va">S</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">8</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span class="r-in"><span class="va">zeros</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">S</span><span class="op">==</span><span class="fl">0</span>, arr.ind<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># obtain (triangulated) support info</span></span>
<span class="r-in"><span class="va">supportP</span> <span class="op">&lt;-</span> <span class="fu"><a href="support4ridgeP.html">support4ridgeP</a></span><span class="op">(</span>nNodes<span class="op">=</span><span class="va">p</span>, zeros<span class="op">=</span><span class="va">zeros</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># determine optimal penalty parameter</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="va">optLambda</span> <span class="op">&lt;-</span> <span class="fu">optPenaltyPchordal</span><span class="op">(</span><span class="va">Y</span>, <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">10</span><span class="op">)</span>, <span class="fl">10</span>, <span class="fl">0.1</span>, zeros<span class="op">=</span><span class="va">supportP</span><span class="op">$</span><span class="va">zeros</span>,</span>
<span class="r-in">  cliques<span class="op">=</span><span class="va">supportP</span><span class="op">$</span><span class="va">cliques</span>, separators<span class="op">=</span><span class="va">supportP</span><span class="op">$</span><span class="va">separators</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"><span class="va">optLambda</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># estimate precision matrix with known (triangulated) support</span></span>
<span class="r-in"><span class="va">Phat</span> <span class="op">&lt;-</span> <span class="fu"><a href="ridgePchordal.html">ridgePchordal</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">optLambda</span>, zeros<span class="op">=</span><span class="va">supportP</span><span class="op">$</span><span class="va">zeros</span>,</span>
<span class="r-in">  cliques<span class="op">=</span><span class="va">supportP</span><span class="op">$</span><span class="va">cliques</span>, separators<span class="op">=</span><span class="va">supportP</span><span class="op">$</span><span class="va">separators</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Progress report .... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt; ---------------------------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt; optimization over                   : 27 out of 36 unique </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt;                                       parameters (75%) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt; cond. number of initial estimate    : 1.95 (if &gt;&gt; 100, consider </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt;                                       larger values of lambda) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt; # graph components                  : 1 (optimization per component) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt; optimization per component          :  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |......................................................................| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt; estimation done ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt; formatting output ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt; overall summary .... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt; initial pen. log-likelihood         : -7.45199157 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt; optimized pen. log-likelihood       : -7.45199081 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt; optimization                        : converged (most likely) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt;                                       for all components </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt; ---------------------------------------------------------------------- </span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Carel F.W. Peeters, Anders Ellern Bilgrau, Wessel N. van Wieringen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

