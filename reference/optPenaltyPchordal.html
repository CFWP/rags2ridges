<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Automatic search for penalty parameter of ridge precision estimator with
known chordal support — optPenaltyPchordal • rags2ridges</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Automatic search for penalty parameter of ridge precision estimator with
known chordal support — optPenaltyPchordal" />
<meta property="og:description" content="Automic search for the optimal ridge penalty parameter for the ridge
estimator of the precision matrix with known chordal support. Optimal in the
sense that it yields the maximum cross-validated likelihood. The search
employs the Brent algorithm as implemented in the
optim function." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rags2ridges</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rags2ridges.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/CFWP/rags2ridges/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Automatic search for penalty parameter of ridge precision estimator with
known chordal support</h1>
    <small class="dont-index">Source: <a href='https://github.com/CFWP/rags2ridges/blob/master/R/rags2ridgesVariants.r'><code>R/rags2ridgesVariants.r</code></a></small>
    <div class="hidden name"><code>optPenaltyPchordal.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Automic search for the optimal ridge penalty parameter for the ridge
estimator of the precision matrix with known chordal support. Optimal in the
sense that it yields the maximum cross-validated likelihood. The search
employs the Brent algorithm as implemented in the
<code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code> function.</p>
    </div>

    <pre class="usage"><span class='fu'>optPenaltyPchordal</span><span class='op'>(</span>
  <span class='va'>Y</span>,
  <span class='va'>lambdaMin</span>,
  <span class='va'>lambdaMax</span>,
  lambdaInit <span class='op'>=</span> <span class='op'>(</span><span class='va'>lambdaMin</span> <span class='op'>+</span> <span class='va'>lambdaMax</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>2</span>,
  <span class='va'>zeros</span>,
  cliques <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  separators <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  target <span class='op'>=</span> <span class='fu'><a href='default.target.html'>default.target</a></span><span class='op'>(</span><span class='fu'><a href='covML.html'>covML</a></span><span class='op'>(</span><span class='va'>Y</span><span class='op'>)</span><span class='op'>)</span>,
  type <span class='op'>=</span> <span class='st'>"Alt"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Y</th>
      <td><p>Data <code>matrix</code>. Variables assumed to be represented by columns.</p></td>
    </tr>
    <tr>
      <th>lambdaMin</th>
      <td><p>A <code>numeric</code> giving the minimum value for the penalty
parameter.</p></td>
    </tr>
    <tr>
      <th>lambdaMax</th>
      <td><p>A <code>numeric</code> giving the maximum value for the penalty
parameter.</p></td>
    </tr>
    <tr>
      <th>lambdaInit</th>
      <td><p>A <code>numeric</code> giving the initial value for the penalty
parameter.</p></td>
    </tr>
    <tr>
      <th>zeros</th>
      <td><p>A <code>matrix</code> with indices of entries of the precision matrix
that are constrained to zero. The matrix comprises two columns, each row
corresponding to an entry of the precision matrix. The first column contains
the row indices and the second the column indices. The specified conditional
independence graph implied by the zero-structure of the precision should be
undirected and decomposable. If not, it is symmetrized and triangulated.</p></td>
    </tr>
    <tr>
      <th>cliques</th>
      <td><p>A <code>list</code>-object containing the node indices per clique
as obtained from the <code><a href='support4ridgeP.html'>support4ridgeP</a></code>-function.</p></td>
    </tr>
    <tr>
      <th>separators</th>
      <td><p>A <code>list</code>-object containing the node indices per
separator as obtained from the <code><a href='support4ridgeP.html'>support4ridgeP</a></code>-function.</p></td>
    </tr>
    <tr>
      <th>target</th>
      <td><p>A target <code>matrix</code> (in precision terms) for Type I ridge
estimators.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>A <code>character</code> indicating the type of ridge estimator to be
used. Must be one of: <code>Alt</code>, <code>ArchI</code>, <code>ArchII</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>numeric</code> with the LOOCV optimal choice for the ridge penalty
parameter.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>See the function <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code> for details on the
implementation of the Brent algorithm.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Miok, V., Wilting, S.M., Van Wieringen, W.N. (2016), "Ridge
estimation of the VAR(1) model and its time series chain graph from
multivariate time-course omics data", <em>Biometrical Journal</em>, 59(1),
172-191.</p>
<p>Van Wieringen, W.N. and Peeters, C.F.W. (2016), "Ridge Estimation of Inverse
Covariance Matrices from High-Dimensional Data", <em>Computational
Statistics and Data Analysis</em>, 103, 284-303.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='ridgePchordal.html'>ridgePchordal</a></code>,
<code><a href='ridgeP.html'>ridgeP</a></code>,
<code><a href='optPenalty.aLOOCV.html'>optPenalty.aLOOCV</a></code>,
<code><a href='optPenalty.kCV.html'>optPenalty.kCV</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Wessel N. van Wieringen.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># generate data</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fl'>8</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>100</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>333</span><span class='op'>)</span>
<span class='va'>Y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>*</span><span class='va'>p</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='va'>n</span>, ncol <span class='op'>=</span> <span class='va'>p</span><span class='op'>)</span>

<span class='co'># define zero structure</span>
<span class='va'>S</span> <span class='op'>&lt;-</span> <span class='fu'><a href='covML.html'>covML</a></span><span class='op'>(</span><span class='va'>Y</span><span class='op'>)</span>
<span class='va'>S</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='fl'>6</span><span class='op'>:</span><span class='fl'>8</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
<span class='va'>S</span><span class='op'>[</span><span class='fl'>6</span><span class='op'>:</span><span class='fl'>8</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
<span class='va'>zeros</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>S</span><span class='op'>==</span><span class='fl'>0</span>, arr.ind<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># obtain (triangulated) support info</span>
<span class='va'>supportP</span> <span class='op'>&lt;-</span> <span class='fu'><a href='support4ridgeP.html'>support4ridgeP</a></span><span class='op'>(</span>nNodes<span class='op'>=</span><span class='va'>p</span>, zeros<span class='op'>=</span><span class='va'>zeros</span><span class='op'>)</span>

<span class='co'># determine optimal penalty parameter</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>optLambda</span> <span class='op'>&lt;-</span> <span class='fu'>optPenaltyPchordal</span><span class='op'>(</span><span class='va'>Y</span>, <span class='fl'>10</span><span class='op'>^</span><span class='op'>(</span><span class='op'>-</span><span class='fl'>10</span><span class='op'>)</span>, <span class='fl'>10</span>, <span class='fl'>0.1</span>, zeros<span class='op'>=</span><span class='va'>supportP</span><span class='op'>$</span><span class='va'>zeros</span>,
  cliques<span class='op'>=</span><span class='va'>supportP</span><span class='op'>$</span><span class='va'>cliques</span>, separators<span class='op'>=</span><span class='va'>supportP</span><span class='op'>$</span><span class='va'>separators</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>optLambda</span> <span class='op'>&lt;-</span> <span class='fl'>0.1</span>

<span class='co'># estimate precision matrix with known (triangulated) support</span>
<span class='va'>Phat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='ridgePchordal.html'>ridgePchordal</a></span><span class='op'>(</span><span class='va'>S</span>, <span class='va'>optLambda</span>, zeros<span class='op'>=</span><span class='va'>supportP</span><span class='op'>$</span><span class='va'>zeros</span>,
  cliques<span class='op'>=</span><span class='va'>supportP</span><span class='op'>$</span><span class='va'>cliques</span>, separators<span class='op'>=</span><span class='va'>supportP</span><span class='op'>$</span><span class='va'>separators</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   
#&gt; Progress report .... 
#&gt; -&gt; ---------------------------------------------------------------------- 
#&gt; -&gt; optimization over                   : 27 out of 36 unique 
#&gt; -&gt;                                       parameters (75%) 
#&gt; -&gt; cond. number of initial estimate    : 1.95 (if &gt;&gt; 100, consider 
#&gt; -&gt;                                       larger values of lambda) 
#&gt; -&gt; # graph components                  : 1 (optimization per component) 
#&gt; -&gt; optimization per component          :  
#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |......................................................................| 100%
#&gt; 
#&gt; -&gt; estimation done ... 
#&gt; -&gt; formatting output ... 
#&gt; -&gt; overall summary .... 
#&gt; -&gt; initial pen. log-likelihood         : -7.45199157 
#&gt; -&gt; optimized pen. log-likelihood       : -7.45199081 
#&gt; -&gt; optimization                        : converged (most likely) 
#&gt; -&gt;                                       for all components 
#&gt; -&gt; ---------------------------------------------------------------------- </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Carel F.W. Peeters, Anders Ellern Bilgrau, Wessel N. van Wieringen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


