<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Test for block-indepedence — GGMblockTest • rags2ridges</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Test for block-indepedence — GGMblockTest"><meta property="og:description" content="Function performing a test that evaluates the null hypothesis of
block-independence against the alternative of block-dependence (presence of
non-zero elements in the off-diagonal block) in the precision matrix using
high-dimensional data. The mentioned test is a permutation-based test (see
details)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rags2ridges</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/rags2ridges.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/CFWP/rags2ridges/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Test for block-indepedence</h1>
    <small class="dont-index">Source: <a href="https://github.com/CFWP/rags2ridges/blob/master/R/rags2ridges.R" class="external-link"><code>R/rags2ridges.R</code></a></small>
    <div class="hidden name"><code>GGMblockTest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function performing a test that evaluates the null hypothesis of
block-independence against the alternative of block-dependence (presence of
non-zero elements in the off-diagonal block) in the precision matrix using
high-dimensional data. The mentioned test is a permutation-based test (see
details).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">GGMblockTest</span><span class="op">(</span></span>
<span>  <span class="va">Y</span>,</span>
<span>  <span class="va">id</span>,</span>
<span>  nPerm <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  target <span class="op">=</span> <span class="fu"><a href="default.target.html">default.target</a></span><span class="op">(</span><span class="fu"><a href="covML.html">covML</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"Alt"</span>,</span>
<span>  lowCiThres <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  ncpus <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Data <code>matrix</code>. Variables assumed to be represented by columns.</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>A <code>numeric</code> vector acting as an indicator variable for two
blocks of the precision matrix. The blocks should be coded as <code>0</code> and
<code>1</code>.</p></dd>


<dt id="arg-nperm">nPerm<a class="anchor" aria-label="anchor" href="#arg-nperm"></a></dt>
<dd><p>A <code>numeric</code> or <code>integer</code> determining the number of
permutations.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>A <code>numeric</code> representing the penalty parameter employed
in the permutation test.</p></dd>


<dt id="arg-target">target<a class="anchor" aria-label="anchor" href="#arg-target"></a></dt>
<dd><p>A target <code>matrix</code> (in precision terms) for Type I ridge
estimators.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>A <code>character</code> indicating the type of ridge estimator to be
used. Must be one of: "Alt", "ArchI", "ArchII".</p></dd>


<dt id="arg-lowcithres">lowCiThres<a class="anchor" aria-label="anchor" href="#arg-lowcithres"></a></dt>
<dd><p>A <code>numeric</code> taking a value between 0 and 1.
Determines speed of efficient p-value calculation.</p></dd>


<dt id="arg-ncpus">ncpus<a class="anchor" aria-label="anchor" href="#arg-ncpus"></a></dt>
<dd><p>A <code>numeric</code> or <code>integer</code> indicating the desired
number of cpus to be used.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A <code>logical</code> indicating if information on progress and
output should be printed on screen.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of class list:</p>
<dl><dt>statistic</dt>
<dd><p>A <code>numeric</code>
representing the observed test statistic (i.e., likelihood ratio).</p></dd>

<dt>pvalue</dt>
<dd><p>A <code>numeric</code> giving the p-value for the block-independence
test.</p></dd>
 <dt>nulldist</dt>
<dd><p>A <code>numeric</code> vector representing the permutation
null distribution for the test statistic.</p></dd>
 <dt>nperm</dt>
<dd><p>A <code>numeric</code>
indicating the number of permutations used for p-value calculation.</p></dd>

<dt>remark</dt>
<dd><p>A <code>"character"</code> that states whether the permutation
algorithm was terminated prematurely or not.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The function performs a permutation test for the null hypothesis of
block-independence against the alternative of block-dependence (presence of
non-zero elements in the off-diagonal block) in the precision matrix using
high-dimensional data. In the low-dimensional setting the common test
statistic under multivariate normality (cf. Anderson, 2003) is:
$$
  \log( \| \hat{\mathbf{\Sigma}}_a \| ) +
  \log( \| \hat{\mathbf{\Sigma}}_b \| ) -
  \log( \| \hat{\mathbf{\Sigma}}   \| ),
$$
where the
\(\hat{\mathbf{\Sigma}}_a\),
\(\hat{\mathbf{\Sigma}}_b\),
\(\hat{\mathbf{\Sigma}}\)
are the estimates of the covariance matrix in the sub- and whole group(s),
respectively.</p>
<p>To accommodate the high-dimensionality the parameters of interest are
estimated in a penalized manner (ridge-type penalization, see
<code><a href="ridgeP.html">ridgeP</a></code>). Penalization involves a degree of freedom (the
penalty parameter: <code>lambda</code>) which needs to be fixed before testing. To
decide on the penalty parameter for testing we refer to the
<code><a href="GGMblockNullPenalty.html">GGMblockNullPenalty</a></code> function. With an informed choice on the
penalty parameter at hand, the null hypothesis is evaluated by permutation.
Hereto the samples are permutated within block. The resulting permuted data
set represents the null hypothesis. Many permuted data sets are generated.
For each permutation the test statistic is calculated. The observed test
statistic is compared to the null distribution from the permutations.</p>
<p>The function implements an efficient permutation resampling algorithm (see
van Wieringen et al., 2008, for details.): If the probability of a p-value
being below <code>lowCiThres</code> is smaller than 0.001 (read: the test is
unlikely to become significant), the permutation analysis is terminated and
a p-value of unity (1) is reported.</p>
<p>When <code>verbose = TRUE</code> also graphical output is generated: A histogram
of the null-distribution. Note that, when <code>ncpus</code> is larger than 1,
functionalities from
<a href="https://cran.r-project.org/package=snowfall" class="external-link">snowfall</a> are imported.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Anderson, T.W. (2003). An Introduction to Multivariate
Statistical Analysis, 3rd Edition. John Wiley.</p>
<p>van Wieringen, W.N., van de Wiel, M.A., and van der Vaart, A.W. (2008). A
Test for Partial Differential Expression. Journal of the American
Statistical Association 103: 1039-1049.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ridgeP.html">ridgeP</a></code>, <code><a href="optPenalty.LOOCVauto.html">optPenalty.LOOCVauto</a></code>,
<code><a href="default.target.html">default.target</a></code>, <code><a href="GGMblockNullPenalty.html">GGMblockNullPenalty</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Wessel N. van Wieringen, Carel F.W. Peeters &lt;carel.peeters@wur.nl&gt;</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Obtain some (high-dimensional) data</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">=</span> <span class="fl">15</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">333</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Generate null distribution of the penalty parameter</span></span></span>
<span class="r-in"><span><span class="va">lambda0dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="GGMblockNullPenalty.html">GGMblockNullPenalty</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">id</span>, <span class="fl">5</span>, <span class="fl">0.001</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Location of null distribution</span></span></span>
<span class="r-in"><span><span class="va">lambdaNull</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">lambda0dist</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Perform test</span></span></span>
<span class="r-in"><span><span class="va">testRes</span> <span class="op">&lt;-</span> <span class="fu">GGMblockTest</span><span class="op">(</span><span class="va">X</span>, <span class="va">id</span>, nPerm <span class="op">=</span> <span class="fl">100</span>, <span class="va">lambdaNull</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 of 100 permutations done, and counting...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 of 100  permutations done </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 of 100 permutations done, and counting...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 of 100  permutations done </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 of 100 permutations done, and counting...</span>
<span class="r-plt img"><img src="GGMblockTest-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Likelihood ratio test for block independence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt; number of permutations : 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt; test statistic         : 0.498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt; p-value                : 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -&gt; remark                 : resampling terminated prematurely due to unlikely significance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Carel F.W. Peeters, Anders Ellern Bilgrau, Wessel N. van Wieringen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

