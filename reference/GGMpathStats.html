<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Gaussian graphical model node pair path statistics — GGMpathStats • rags2ridges</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Gaussian graphical model node pair path statistics — GGMpathStats" />
<meta property="og:description" content="Function that calculates, for a specified node pair representing endpoints,
path statistics from a sparse precision matrix. The sparse precision matrix
is taken to represent the conditional independence graph of a Gaussian
graphical model. The contribution to the observed covariance between the
specified endpoints is calculated for each (heuristically) determined path
between the endpoints." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rags2ridges</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rags2ridges.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/CFWP/rags2ridges/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Gaussian graphical model node pair path statistics</h1>
    <small class="dont-index">Source: <a href='https://github.com/CFWP/rags2ridges/blob/master/R/rags2ridges.R'><code>R/rags2ridges.R</code></a></small>
    <div class="hidden name"><code>GGMpathStats.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function that calculates, for a specified node pair representing endpoints,
path statistics from a sparse precision matrix. The sparse precision matrix
is taken to represent the conditional independence graph of a Gaussian
graphical model. The contribution to the observed covariance between the
specified endpoints is calculated for each (heuristically) determined path
between the endpoints.</p>
    </div>

    <pre class="usage"><span class='fu'>GGMpathStats</span><span class='op'>(</span>
  <span class='va'>P0</span>,
  <span class='va'>node1</span>,
  <span class='va'>node2</span>,
  neiExpansions <span class='op'>=</span> <span class='fl'>2</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  graph <span class='op'>=</span> <span class='cn'>TRUE</span>,
  nrPaths <span class='op'>=</span> <span class='fl'>2</span>,
  lay <span class='op'>=</span> <span class='st'>"layout_in_circle"</span>,
  coords <span class='op'>=</span> <span class='cn'>NULL</span>,
  nodecol <span class='op'>=</span> <span class='st'>"skyblue"</span>,
  Vsize <span class='op'>=</span> <span class='fl'>15</span>,
  Vcex <span class='op'>=</span> <span class='fl'>0.6</span>,
  VBcolor <span class='op'>=</span> <span class='st'>"darkblue"</span>,
  VLcolor <span class='op'>=</span> <span class='st'>"black"</span>,
  all.edges <span class='op'>=</span> <span class='cn'>TRUE</span>,
  prune <span class='op'>=</span> <span class='cn'>TRUE</span>,
  legend <span class='op'>=</span> <span class='cn'>TRUE</span>,
  scale <span class='op'>=</span> <span class='fl'>1</span>,
  Lcex <span class='op'>=</span> <span class='fl'>0.8</span>,
  PTcex <span class='op'>=</span> <span class='fl'>2</span>,
  main <span class='op'>=</span> <span class='st'>""</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>P0</th>
      <td><p>Sparse (possibly standardized) precision matrix.</p></td>
    </tr>
    <tr>
      <th>node1</th>
      <td><p>A <code>numeric</code> specifying an endpoint. The numeric should
correspond to a row/column of the precision matrix and as such represents
the corresponding variable.</p></td>
    </tr>
    <tr>
      <th>node2</th>
      <td><p>A <code>numeric</code> specifying a second endpoint. The numeric
should correspond to a row/column of the precision matrix and as such
represents the corresponding variable.</p></td>
    </tr>
    <tr>
      <th>neiExpansions</th>
      <td><p>A <code>numeric</code> determining how many times the
neighborhood around the respective endpoints should be expanded in the
search for shortest paths between the node pair.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A <code>logical</code> indicating if a summary of the results
should be printed on screen.</p></td>
    </tr>
    <tr>
      <th>graph</th>
      <td><p>A <code>logical</code> indicating if the strongest paths should be
visualized with a graph.</p></td>
    </tr>
    <tr>
      <th>nrPaths</th>
      <td><p>A <code>numeric</code> indicating the number of paths (with the
highest contribution to the marginal covariance between the indicated node
pair) to be visualized/highlighted.</p></td>
    </tr>
    <tr>
      <th>lay</th>
      <td><p>A <code>character</code> mimicking a call to <code>igraph</code>
layout functions. Determines the placement of vertices.</p></td>
    </tr>
    <tr>
      <th>coords</th>
      <td><p>A <code>matrix</code> containing coordinates. Alternative to the
lay-argument for determining the placement of vertices.</p></td>
    </tr>
    <tr>
      <th>nodecol</th>
      <td><p>A <code>character</code> determining the color of <code>node1</code> and
<code>node2</code>.</p></td>
    </tr>
    <tr>
      <th>Vsize</th>
      <td><p>A <code>numeric</code> determining the vertex size.</p></td>
    </tr>
    <tr>
      <th>Vcex</th>
      <td><p>A <code>numeric</code> determining the size of the vertex labels.</p></td>
    </tr>
    <tr>
      <th>VBcolor</th>
      <td><p>A <code>character</code> determining the color of the vertex
borders.</p></td>
    </tr>
    <tr>
      <th>VLcolor</th>
      <td><p>A <code>character</code> determining the color of the vertex
labels.</p></td>
    </tr>
    <tr>
      <th>all.edges</th>
      <td><p>A <code>logical</code> indicating if edges other than those
implied by the <code>nrPaths</code>-paths between <code>node1</code> and node2 should
also be visualized.</p></td>
    </tr>
    <tr>
      <th>prune</th>
      <td><p>A <code>logical</code> determining if vertices of degree 0 should be
removed.</p></td>
    </tr>
    <tr>
      <th>legend</th>
      <td><p>A <code>logical</code> indicating if the graph should come with a
legend.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>A <code>numeric</code> representing a scale factor for visualizing
strenght of edges. It is a relative scaling factor, in the sense that the
edges implied by the <code>nrPaths</code>-paths between <code>node1</code> and node2
have edge thickness that is twice this scaling factor (so it is a scaling
factor vis-a-vis the unimplied edges).</p></td>
    </tr>
    <tr>
      <th>Lcex</th>
      <td><p>A <code>numeric</code> determining the size of the legend box.</p></td>
    </tr>
    <tr>
      <th>PTcex</th>
      <td><p>A <code>numeric</code> determining the size of the exemplary lines in
the legend box.</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>A <code>character</code> giving the main figure title.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class list:</p>
<dt>pathStats</dt><dd><p>A <code>matrix</code> specifying
the paths, their respective lengths, and their respective contributions to
the marginal covariance between the endpoints.</p></dd> <dt>paths</dt><dd><p>A <code>list</code>
representing the respective paths as numeric vectors.</p></dd> <dt>Identifier</dt><dd><p>A
<code>data.frame</code> in which each numeric from <code>paths</code> is connected to an
identifier such as a variable name.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The conditional independence graph (as implied by the sparse precision
matrix) is undirected. In undirected graphs origin and destination are
interchangeable and are both referred to as 'endpoints' of a path. The
function searches for shortest paths between the specified endpoints
<code>node1</code> and <code>node2</code>. It searches for shortest paths that visit
nodes only once. The shortest paths between the provided endpoints are
determined heuristically by the following procedure. The search is initiated
by application of the <code>get.all.shortest.paths</code>-function from the
<code>igraph</code>-package, which yields all shortest paths between the
nodes. Next, the neighborhoods of the endpoints are defined (excluding the
endpoints themselves). Then, the shortest paths are found between: (a)
<code>node1</code> and node <em>Vs</em> in its neighborhood; (b) node <em>Vs</em> in
the <code>node1</code>-neighborhood and node <em>Ve</em> in the
<code>node2</code>-neighborhood; and (c) node <em>Ve</em> in the
<code>node2</code>-neighborhood and <code>node2</code>. These paths are glued and new
shortest path candidates are obtained (preserving only novel paths). In
additional iterations (specified by <code>neiExpansions</code>) the <code>node1</code>-
and <code>node2</code>-neighborhood are expanded by including their neighbors
(still excluding the endpoints) and shortest paths are again searched as
described above.</p>
<p>The contribution of a particular path to the observed covariance between the
specified node pair is calculated in accordance with Theorem 1 of Jones and
West (2005). As in Jones and West (2005), paths whose weights have an
opposite sign to the marginal covariance (between endnodes of the path) are
referred to as 'moderating paths' while paths whose weights have the same
sign as the marginal covariance are referred to as 'mediating' paths. Such
paths are visualized when <code>graph = TRUE</code>.</p>
<p>All arguments following the <code>graph</code> argument are only (potentially)
used when <code>graph = TRUE</code>. When <code>graph = TRUE</code> the conditional
independence graph is returned with the paths highlighted that have the
highest contribution to the marginal covariance between the specified
endpoints. The number of paths highlighted is indicated by <code>nrPaths</code>.
The edges of mediating paths are represented in green while the edges of
moderating paths are represented in red. When <code>all.edges = TRUE</code> the
edges other than those implied by the <code>nrPaths</code>-paths between
<code>node1</code> and node2 are also visualized (in lightgrey). When
<code>all.edges = FALSE</code> only the mediating and moderating paths implied by
<code>nrPaths</code> are visualized.</p>
<p>The default layout gives a circular placement of the vertices. Most layout
functions supported by <code>igraph</code> are supported (the function is
partly a wrapper around certain <code>igraph</code> functions). The igraph
layouts can be invoked by a <code>character</code> that mimicks a call to a
<code>igraph</code> layout functions in the <code>lay</code> argument. When using
<code>lay = NULL</code> one can specify the placement of vertices with the
<code>coords</code> argument. The row dimension of this matrix should equal the
number of (pruned) vertices. The column dimension then should equal 2 (for
2D layouts) or 3 (for 3D layouts). The <code>coords</code> argument can also be
viewed as a convenience argument as it enables one, e.g., to layout a graph
according to the coordinates of a previous call to <code>Ugraph</code>. If both
the the lay and the coords arguments are not <code>NULL</code>, the lay argument
takes precedence</p>
<p>The arguments <code>Lcex</code> and <code>PTcex</code> are only used when <code>legend =
TRUE</code>. If <code>prune = TRUE</code> the vertices of degree 0 (vertices not
implicated by any edge) are removed. For the colors supported by the
arguments <code>nodecol</code>, <code>Vcolor</code>, and <code>VBcolor</code>, see
<a href='https://stat.columbia.edu/~tzheng/files/Rcolor.pdf'>https://stat.columbia.edu/~tzheng/files/Rcolor.pdf</a>.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Eppstein (1998) describes a more sophisticated algorithm for finding
the top <em>k</em> shortest paths in a graph.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Eppstein, D. (1998). Finding the k Shortest Paths. SIAM Journal
on computing 28: 652-673.</p>
<p>Jones, B., and West, M. (2005). Covariance Decomposition in Undirected
Gaussian Graphical Models. Biometrika 92: 779-786.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='ridgeP.html'>ridgeP</a></code>, <code><a href='optPenalty.LOOCVauto.html'>optPenalty.LOOCVauto</a></code>,
<code><a href='sparsify.html'>sparsify</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Wessel N. van Wieringen, Carel F.W. Peeters &lt;carel.peeters@wur.nl&gt;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Obtain some (high-dimensional) data</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fl'>25</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>333</span><span class='op'>)</span>
<span class='va'>X</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>*</span><span class='va'>p</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='va'>n</span>, ncol <span class='op'>=</span> <span class='va'>p</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>letters</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>p</span><span class='op'>]</span>

<span class='co'>## Obtain regularized precision under optimal penalty</span>
<span class='va'>OPT</span> <span class='op'>&lt;-</span> <span class='fu'><a href='optPenalty.LOOCVauto.html'>optPenalty.LOOCVauto</a></span><span class='op'>(</span><span class='va'>X</span>, lambdaMin <span class='op'>=</span> <span class='fl'>.5</span>, lambdaMax <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span>

<span class='co'>## Determine support regularized standardized precision under optimal penalty</span>
<span class='va'>PC0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sparsify.html'>sparsify</a></span><span class='op'>(</span><span class='va'>OPT</span><span class='op'>$</span><span class='va'>optPrec</span>, threshold <span class='op'>=</span> <span class='st'>"localFDR"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>sparseParCor</span>
</div><div class='output co'>#&gt; Step 1... determine cutoff point
#&gt; Step 2... estimate parameters of null distribution and eta0
#&gt; Step 3... compute p-values and estimate empirical PDF/CDF
#&gt; Step 4... compute q-values and local fdr
#&gt; Step 5... prepare for plotting</div><div class='img'><img src='GGMpathStats-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; - Retained elements:  11 
#&gt; - Corresponding to 3.67 % of possible edges 
#&gt;  </div><div class='input'>
<span class='co'>## Obtain information on mediating and moderating paths between nodes 14 and 23</span>
<span class='va'>pathStats</span> <span class='op'>&lt;-</span> <span class='fu'>GGMpathStats</span><span class='op'>(</span><span class='va'>PC0</span>, <span class='fl'>14</span>, <span class='fl'>23</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span>, prune <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Covariance between node pair : 0.06757 
#&gt; ----------------------------------------
#&gt;         path length contribution
#&gt; 1     14--23      1      0.07211
#&gt; 2 14--17--23      2     -0.00453
#&gt; ----------------------------------------
#&gt; Sum path contributions       : 0.06757 </div><div class='output co'>#&gt; <span class='warning'>Warning: 'as.is' should be specified by the caller; using TRUE</span></div><div class='output co'>#&gt; <span class='warning'>Warning: 'as.is' should be specified by the caller; using TRUE</span></div><div class='img'><img src='GGMpathStats-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>pathStats</span>
</div><div class='output co'>#&gt; $pathStats
#&gt;            length contribution
#&gt; 14--23          1  0.072107154
#&gt; 14--17--23      2 -0.004533758
#&gt; 
#&gt; $paths
#&gt; $paths$`14--23`
#&gt; + 2/25 vertices, named, from e70a180:
#&gt; [1] 14 23
#&gt; 
#&gt; $paths$`14--17--23`
#&gt; + 3/25 vertices, named, from e70a180:
#&gt; [1] 14 17 23
#&gt; 
#&gt; 
#&gt; $Identifier
#&gt;    Numeric VarName
#&gt; 1        1       a
#&gt; 2        2       b
#&gt; 3        3       c
#&gt; 4        4       d
#&gt; 5        5       e
#&gt; 6        6       f
#&gt; 7        7       g
#&gt; 8        8       h
#&gt; 9        9       i
#&gt; 10      10       j
#&gt; 11      11       k
#&gt; 12      12       l
#&gt; 13      13       m
#&gt; 14      14       n
#&gt; 15      15       o
#&gt; 16      16       p
#&gt; 17      17       q
#&gt; 18      18       r
#&gt; 19      19       s
#&gt; 20      20       t
#&gt; 21      21       u
#&gt; 22      22       v
#&gt; 23      23       w
#&gt; 24      24       x
#&gt; 25      25       y
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Carel F.W. Peeters, Anders Ellern Bilgrau, Wessel N. van Wieringen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


