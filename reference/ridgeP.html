<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Ridge estimation for high-dimensional precision matrices — ridgeP • rags2ridges</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Ridge estimation for high-dimensional precision matrices — ridgeP"><meta property="og:description" content="Function that calculates various Ridge estimators for high-dimensional
precision matrices."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rags2ridges</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/rags2ridges.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/CFWP/rags2ridges/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Ridge estimation for high-dimensional precision matrices</h1>
    <small class="dont-index">Source: <a href="https://github.com/CFWP/rags2ridges/blob/master/R/rags2ridges.R" class="external-link"><code>R/rags2ridges.R</code></a></small>
    <div class="hidden name"><code>ridgeP.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function that calculates various Ridge estimators for high-dimensional
precision matrices.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ridgeP</span><span class="op">(</span><span class="va">S</span>, <span class="va">lambda</span>, type <span class="op">=</span> <span class="st">"Alt"</span>, target <span class="op">=</span> <span class="fu"><a href="default.target.html">default.target</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-s">S<a class="anchor" aria-label="anchor" href="#arg-s"></a></dt>
<dd><p>Sample covariance <code>matrix</code>.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>A <code>numeric</code> representing the value of the penalty
parameter.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>A <code>character</code> indicating the type of ridge estimator to be
used. Must be one of: "Alt", "ArchI", "ArchII".</p></dd>


<dt id="arg-target">target<a class="anchor" aria-label="anchor" href="#arg-target"></a></dt>
<dd><p>A target <code>matrix</code> (in precision terms) for Type I ridge
estimators.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Function returns a regularized precision <code>matrix</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function can calculate various ridge estimators for high-dimensional
precision matrices. Current (well-known) ridge estimators can be roughly
divided in two archetypes. The first archetypal form employs a convex
combination of \(\mathbf{S}\) and a positive definite (p.d.) target matrix
  \(\mathbf{T}\):
  \(\hat{\mathbf{\Omega}}^{\mathrm{I}}(\lambda_{\mathrm{I}})
  = [(1-\lambda_{\mathrm{I}}) \mathbf{S} + \lambda_{\mathrm{I}}\mathbf{T}]^{-1}\),
with \(\lambda_{\mathrm{I}} \in (0,1]\).
A common target choice is for \(\mathbf{T}\) to be diagonal with
  \((\mathbf{T})_{jj} = (\mathbf{S})_{jj}\) for \(j=1, \ldots, p\).
The second archetypal form can be given as
  \(\hat{\mathbf{\Omega}}^{\mathrm{II}}(\lambda_{\mathrm{II}})
   = (\mathbf{S} + \lambda_{\mathrm{II}} \mathbf{I}_{p})^{-1}\)
with \(\lambda_{\mathrm{II}} \in (0, \infty)\). Viewed from a penalized
estimation perspective, the two archetypes utilize penalties that do not
coincide with the matrix-analogue of the common ridge penalty. van Wieringen
and Peeters (2015) derive analytic expressions for alternative Type I and
Type II ridge precision estimators based on a proper L2-penalty. Their
alternative Type I estimator (target shrinkage) takes the form
  $$
    \hat{\mathbf{\Omega}}^{\mathrm{I}a}(\lambda_{a})
    = \left\{
        \left[\lambda_{a}\mathbf{I}_{p} + \frac{1}{4}(\mathbf{S} -
              \lambda_{a}\mathbf{T})^{2}\right]^{1/2} +
        \frac{1}{2}(\mathbf{S} - \lambda_{a}\mathbf{T})
      \right\}^{-1},
  $$
while their alternative Type II estimator can be given as a special case of
the former:
  $$
    \hat{\mathbf{\Omega}}^{\mathrm{II}a}(\lambda_{a}) =
    \left\{
      \left[\lambda_{a}\mathbf{I}_{p} +
              \frac{1}{4}\mathbf{S}^{2}\right]^{1/2} +
      \frac{1}{2}\mathbf{S}
    \right\}^{-1}.
  $$
These alternative estimators were shown to be superior to the archetypes in
terms of risk under various loss functions (van Wieringen and Peeters, 2015).</p>
<p>The <code>lambda</code> parameter in <code>ridgeP</code> generically indicates the
penalty parameter. It must be chosen in accordance with the type of ridge
estimator employed. The domains for the penalty parameter in the archetypal
estimators are given above. The domain for <code>lambda</code> in the alternative
estimators is \((0, \infty)\). The <code>type</code> parameter specifies the type
of ridge estimator. Specifying <code>type = "ArchI"</code> leads to usage of the
archetypal I estimator while specifying <code>type = "ArchII"</code> leads to usage
of the archetypal II estimator. In the latter situation the argument
<code>target</code> remains unused. Specifying <code>type = "Alt"</code> enables usage of
the alternative ridge estimators: when <code>type = "Alt"</code> and the
<code>target</code> matrix is p.d. one obtains the alternative Type I estimator;
when <code>type = "Alt"</code> and the <code>target</code> matrix is specified to be the
null-matrix one obtains the alternative Type II estimator.</p>
<p>The Type I estimators thus employ target shrinkage. The default target for
both the archetype and alternative is <code>default.target(S)</code>. When
<code>target</code> is not the null-matrix it is expected to be p.d. for the
alternative type I estimator. The target is always expected to be p.d. in
case of the archetypal I estimator. The archetypal Type I ridge estimator is
rotation equivariant when the target is of the form \(\mu\mathbf{I}_{p}\)
with \(\mu \in (0,\infty)\). The archetypal Type II estimator is rotation
equivariant by definition. When the target is of the form
\(\varphi\mathbf{I}_{p}\) with \(\varphi \in [0,\infty)\), then the
alternative ridge estimator is rotation equivariant. Its analytic computation
is then particularly speedy as the (relatively) expensive matrix square root
can then be circumvented.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>van Wieringen, W.N. &amp; Peeters, C.F.W. (2016). Ridge Estimation
of Inverse Covariance Matrices from High-Dimensional Data, Computational
Statistics &amp; Data Analysis, vol. 103: 284-303. Also available as
arXiv:1403.0904v3 [stat.ME].</p>
<p>van Wieringen, W.N. &amp; Peeters, C.F.W. (2015). Application of a New Ridge
Estimator of the Inverse Covariance Matrix to the Reconstruction of
Gene-Gene Interaction Networks. In: di Serio, C., Lio, P., Nonis, A., and
Tagliaferri, R. (Eds.) `Computational Intelligence Methods for
Bioinformatics and Biostatistics'. Lecture Notes in Computer Science, vol.
8623. Springer, pp. 170-179.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="default.target.html">default.target</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Carel F.W. Peeters &lt;carel.peeters@wur.nl&gt;, Anders E. Bilgrau</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">333</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Obtain some (high-dimensional) data</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">25</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">]</span> <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">Cx</span> <span class="op">&lt;-</span> <span class="fu"><a href="covML.html">covML</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Obtain regularized precision matrix</span></span></span>
<span class="r-in"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fu">ridgeP</span><span class="op">(</span><span class="va">Cx</span>, lambda <span class="op">=</span> <span class="fl">10</span>, type <span class="op">=</span> <span class="st">"Alt"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A 25 x 25 ridge precision matrix estimate with lambda = 10.000000 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A 25 x 25 ridge precision matrix estimate with lambda = 10.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               a            b           c            d            e …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a  0.7586005611 -0.003388106 -0.06230663 -0.002600351  0.017829395 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b -0.0033881061  0.824243512 -0.02012367 -0.008647220 -0.031021296 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c -0.0623066280 -0.020123673  0.76471884 -0.038737601  0.026085391 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d -0.0026003511 -0.008647220 -0.03873760  0.817518072  0.025132790 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e  0.0178293946 -0.031021296  0.02608539  0.025132790  0.774812407 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f  0.0008224896  0.007036266  0.01612838  0.002211579 -0.007716194 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               f …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a  0.0008224896 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b  0.0070362659 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c  0.0161283801 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d  0.0022115795 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e -0.0077161936 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f  0.8303406862 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> … 19 more rows and 19 more columns</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'as.is' should be specified by the caller; using TRUE</span>
<span class="r-plt img"><img src="ridgeP-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Carel F.W. Peeters, Anders Ellern Bilgrau, Wessel N. van Wieringen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

