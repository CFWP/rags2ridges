<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Identify optimal ridge and fused ridge penalties — optPenalty.fused.grid • rags2ridges</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Identify optimal ridge and fused ridge penalties — optPenalty.fused.grid"><meta property="og:description" content="Functions to find the optimal ridge and fusion penalty parameters via
leave-one-out cross validation. The functions support leave-one-out
cross-validation (LOOCV), \(k\)-fold CV, and two forms of approximate
LOOCV. Depending on the used function, general numerical optimization or a
grid-based search is used."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rags2ridges</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/rags2ridges.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/CFWP/rags2ridges/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Identify optimal ridge and fused ridge penalties</h1>
    <small class="dont-index">Source: <a href="https://github.com/CFWP/rags2ridges/blob/master/R/rags2ridgesFused.R" class="external-link"><code>R/rags2ridgesFused.R</code></a></small>
    <div class="hidden name"><code>optPenalty.fused.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Functions to find the optimal ridge and fusion penalty parameters via
leave-one-out cross validation. The functions support leave-one-out
cross-validation (LOOCV), \(k\)-fold CV, and two forms of approximate
LOOCV. Depending on the used function, general numerical optimization or a
grid-based search is used.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">optPenalty.fused.grid</span><span class="op">(</span></span>
<span>  <span class="va">Ylist</span>,</span>
<span>  <span class="va">Tlist</span>,</span>
<span>  lambdas <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span>, length.out <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>,</span>
<span>  lambdaFs <span class="op">=</span> <span class="va">lambdas</span>,</span>
<span>  cv.method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LOOCV"</span>, <span class="st">"aLOOCV"</span>, <span class="st">"sLOOCV"</span>, <span class="st">"kCV"</span><span class="op">)</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">optPenalty.fused.auto</span><span class="op">(</span></span>
<span>  <span class="va">Ylist</span>,</span>
<span>  <span class="va">Tlist</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  cv.method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LOOCV"</span>, <span class="st">"aLOOCV"</span>, <span class="st">"sLOOCV"</span>, <span class="st">"kCV"</span><span class="op">)</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">lambda.init</span>,</span>
<span>  maxit.ridgeP.fused <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  optimizer <span class="op">=</span> <span class="st">"optim"</span>,</span>
<span>  maxit.optimizer <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  optim.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace <span class="op">=</span> <span class="va">verbose</span>, maxit <span class="op">=</span> <span class="va">maxit.optimizer</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">optPenalty.fused</span><span class="op">(</span></span>
<span>  <span class="va">Ylist</span>,</span>
<span>  <span class="va">Tlist</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fu"><a href="default.penalty.html">default.penalty</a></span><span class="op">(</span><span class="va">Ylist</span><span class="op">)</span>,</span>
<span>  cv.method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LOOCV"</span>, <span class="st">"aLOOCV"</span>, <span class="st">"sLOOCV"</span>, <span class="st">"kCV"</span><span class="op">)</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-ylist">Ylist<a class="anchor" aria-label="anchor" href="#arg-ylist"></a></dt>
<dd><p>A <code>list</code> of \(G\) matrices of data with \(n_g\) samples
in the rows and \(p\) variables in the columns corresponding to \(G\)
classes of data.</p></dd>


<dt id="arg-tlist">Tlist<a class="anchor" aria-label="anchor" href="#arg-tlist"></a></dt>
<dd><p>A <code>list</code> of \(G\) of p.d. class target matrices of size
\(p\) times \(p\).</p></dd>


<dt id="arg-lambdas">lambdas<a class="anchor" aria-label="anchor" href="#arg-lambdas"></a></dt>
<dd><p>A <code>numeric</code> vector of positive ridge penalties.</p></dd>


<dt id="arg-lambdafs">lambdaFs<a class="anchor" aria-label="anchor" href="#arg-lambdafs"></a></dt>
<dd><p>A <code>numeric</code> vector of non-negative fusion penalties.</p></dd>


<dt id="arg-cv-method">cv.method<a class="anchor" aria-label="anchor" href="#arg-cv-method"></a></dt>
<dd><p><code>character</code> giving the cross-validation (CV) to use.
The allowed values are <code>"LOOCV"</code>, <code>"aLOOCV"</code>, <code>"sLOOCV"</code>,
<code>"kCV"</code> for leave-one-out cross validation (LOOCV), appproximate
LOOCV, special LOOCV, and k-fold CV, respectively.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p><code>integer</code> giving the number of approximately equally sized
parts each class is partioned into for \(k\)-fold CV.  Only use if
<code>cv.method</code> is <code>"kCV"</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><code>logical</code>. If <code>TRUE</code>, progress information is
printed to the console.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>For <code>optPenalty.fused</code>, arguments are passed to
<code>optPenalty.fused.grid</code> or <code>optPenalty.fused.auto</code> depending on
the value of <code>grid</code>.  In <code>optPenalty.fused.grid</code>, arguments are
passed to <code>ridgeP.fused</code>.  In <code>optPenalty.fused.auto</code>, arguments
are passed to the optimizer.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>A symmetric <code>character</code> <code>matrix</code> encoding the class
of penalty matrices to cross-validate over.  The diagonal elements
correspond to the class-specific ridge penalties whereas the off-diagonal
elements correspond to the fusion penalties.  The unique elements of lambda
specify the penalties to determine by the method specified by
<code>cv.method</code>.  The penalties can be fixed if they are coercible to
numeric values, such as e.g. <code>"0"</code>, <code>"2.71"</code> or <code>"3.14"</code>.
Fusion between pairs can be "left out"" using either of <code>""</code>,
<code>NA</code>, <code>"NA"</code>, or <code>"0"</code>.  See <code><a href="default.penalty.html">default.penalty</a></code>
for help on the construction hereof and more details.  Unused and can be
omitted if <code>grid == TRUE</code>.</p></dd>


<dt id="arg-lambda-init">lambda.init<a class="anchor" aria-label="anchor" href="#arg-lambda-init"></a></dt>
<dd><p>A <code>numeric</code> penalty <code>matrix</code> of initial values
passed to the optimizer. If omitted, the function selects a starting values
using a common ridge penaltiy (determined by 1D optimization) and all
fusion penalties to zero.</p></dd>


<dt id="arg-maxit-ridgep-fused">maxit.ridgeP.fused<a class="anchor" aria-label="anchor" href="#arg-maxit-ridgep-fused"></a></dt>
<dd><p>A <code>integer</code> giving the maximum number of
iterations allowed for each fused ridge fit.</p></dd>


<dt id="arg-optimizer">optimizer<a class="anchor" aria-label="anchor" href="#arg-optimizer"></a></dt>
<dd><p><code>character</code>. Either <code>"optim"</code> or <code>"nlm"</code>
determining which optimizer to use.</p></dd>


<dt id="arg-maxit-optimizer">maxit.optimizer<a class="anchor" aria-label="anchor" href="#arg-maxit-optimizer"></a></dt>
<dd><p>A <code>integer</code> giving the maximum number of
iterations allowed in the optimization procedure.</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p><code>logical</code>. If <code>TRUE</code> additional output from the
optimizer is appended to the output as an attribute.</p></dd>


<dt id="arg-optim-control">optim.control<a class="anchor" aria-label="anchor" href="#arg-optim-control"></a></dt>
<dd><p>A <code>list</code> of control arguments for
<code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>.</p></dd>


<dt id="arg-grid">grid<a class="anchor" aria-label="anchor" href="#arg-grid"></a></dt>
<dd><p><code>logical.</code> Should a grid based search be used? Default is
<code>FALSE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>optPenalty.fused.auto</code> returns a <code>list</code>:<br></p>
<dl><dt>Plist</dt>
<dd><p>A
  <code>list</code> of the precision estimates for the optimal parameters.</p></dd>

  <dt>lambda</dt>
<dd><p>The estimated optimal fused penalty matrix.</p></dd>

  <dt>lambda.unique</dt>
<dd><p>The unique entries of the <code>lambda</code>.  A more
  concise overview of <code>lambda</code></p></dd>
 <dt>value</dt>
<dd><p>The value of the loss
  function in the estimated optimum.</p></dd>


  </dl><p><code>optPenalty.fused.LOOCV</code> returns a <code>list</code>:<br></p>
<dl><dt>ridge</dt>
<dd><p>A
  <code>numeric</code> vector of grid values for the ridge penalty</p></dd>

  <dt>fusion</dt>
<dd><p>The <code>numeric</code> vector of grid values for the fusion
  penalty</p></dd>
 <dt>fcvl</dt>
<dd><p>The <code>numeric</code> <code>matrix</code> of evaluations of the
  loss function</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><code>optPenalty.fused.auto</code> serves a utilizes <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> for
identifying the optimal fused parameters and works for general classes of
penalty graphs.</p>
<p><code>optPenalty.fused.grid</code> gives a grid-based evaluation of the
(approximate) LOOCV loss.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Bilgrau, A.E., Peeters, C.F.W., Eriksen, P.S., Boegsted, M., and
  van Wieringen, W.N. (2020).  Targeted Fused Ridge Estimation of Inverse
  Covariance Matrices from Multiple High-Dimensional Data Classes.  Journal
  of Machine Learning Research, 21(26): 1-52.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>See also <code><a href="default.penalty.html">default.penalty</a></code>, <code>optPenalty.LOOCV</code>.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Anders Ellern Bilgrau, Carel F.W. Peeters &lt;carel.peeters@wur.nl&gt;,
  Wessel N. van Wieringen</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Generate some (not so) high-dimensional data witn (not so) many samples</span></span></span>
<span class="r-in"><span><span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Ylist</span> <span class="op">&lt;-</span> <span class="fu"><a href="createS.html">createS</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">ns</span>, p <span class="op">=</span> <span class="fl">6</span>, dataset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Slist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">Ylist</span>, <span class="va">covML</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Tlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="default.target.fused.html">default.target.fused</a></span><span class="op">(</span><span class="va">Slist</span>, <span class="va">ns</span>, type <span class="op">=</span> <span class="st">"DIAES"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Grid-based</span></span></span>
<span class="r-in"><span><span class="va">lambdas</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">3</span>, length.out <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">optPenalty.fused.grid</span><span class="op">(</span><span class="va">Ylist</span>, <span class="va">Tlist</span>,</span></span>
<span class="r-in"><span>                           lambdas <span class="op">=</span> <span class="va">lambdas</span>,</span></span>
<span class="r-in"><span>                           cv.method <span class="op">=</span> <span class="st">"LOOCV"</span>, maxit <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">optPenalty.fused.grid</span><span class="op">(</span><span class="va">Ylist</span>, <span class="va">Tlist</span>,</span></span>
<span class="r-in"><span>                           lambdas <span class="op">=</span> <span class="va">lambdas</span>,</span></span>
<span class="r-in"><span>                           cv.method <span class="op">=</span> <span class="st">"aLOOCV"</span>, maxit <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu">optPenalty.fused.grid</span><span class="op">(</span><span class="va">Ylist</span>, <span class="va">Tlist</span>,</span></span>
<span class="r-in"><span>                           lambdas <span class="op">=</span> <span class="va">lambdas</span>,</span></span>
<span class="r-in"><span>                           cv.method <span class="op">=</span> <span class="st">"sLOOCV"</span>, maxit <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">optPenalty.fused.grid</span><span class="op">(</span><span class="va">Ylist</span>, <span class="va">Tlist</span>,</span></span>
<span class="r-in"><span>                           lambdas <span class="op">=</span> <span class="va">lambdas</span>,</span></span>
<span class="r-in"><span>                           cv.method <span class="op">=</span> <span class="st">"kCV"</span>, k <span class="op">=</span> <span class="fl">2</span>, maxit <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Numerical optimization (uses the default "optim" optimizer with method "BFGS")</span></span></span>
<span class="r-in"><span><span class="va">aa</span> <span class="op">&lt;-</span> <span class="fu">optPenalty.fused.auto</span><span class="op">(</span><span class="va">Ylist</span>, <span class="va">Tlist</span>, cv.method <span class="op">=</span> <span class="st">"LOOCV"</span>, method <span class="op">=</span> <span class="st">"BFGS"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">aa</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bb</span> <span class="op">&lt;-</span> <span class="fu">optPenalty.fused.auto</span><span class="op">(</span><span class="va">Ylist</span>, <span class="va">Tlist</span>, cv.method <span class="op">=</span> <span class="st">"aLOOCV"</span>, method <span class="op">=</span> <span class="st">"BFGS"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bb</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu">optPenalty.fused.auto</span><span class="op">(</span><span class="va">Ylist</span>, <span class="va">Tlist</span>, cv.method <span class="op">=</span> <span class="st">"sLOOCV"</span>, method <span class="op">=</span> <span class="st">"BFGS"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu">optPenalty.fused.auto</span><span class="op">(</span><span class="va">Ylist</span>, <span class="va">Tlist</span>, cv.method <span class="op">=</span> <span class="st">"kCV"</span>, k<span class="op">=</span><span class="fl">3</span>, method<span class="op">=</span><span class="st">"BFGS"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dd</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># Plot the results</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># LOOCV</span></span></span>
<span class="r-in"><span><span class="co"># Get minimums and plot</span></span></span>
<span class="r-in"><span><span class="va">amin</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">lambda</span>, <span class="va">a</span><span class="op">$</span><span class="va">lambdaF</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">fcvl</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">aamin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">aa</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">aa</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/filled.contour.html" class="external-link">filled.contour</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">lambdaF</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">fcvl</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">heat.colors</span>,</span></span>
<span class="r-in"><span>               plot.axes <span class="op">=</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">amin</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">amin</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>;</span></span>
<span class="r-in"><span>                            <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">aamin</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">aamin</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span>;</span></span>
<span class="r-in"><span>                            <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">}</span>,</span></span>
<span class="r-in"><span>               xlab <span class="op">=</span> <span class="st">"lambda"</span>, ylab <span class="op">=</span> <span class="st">"lambdaF"</span>, main <span class="op">=</span> <span class="st">"LOOCV"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Approximate LOOCV</span></span></span>
<span class="r-in"><span><span class="co"># Get minimums and plot</span></span></span>
<span class="r-in"><span><span class="va">bmin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">lambda</span>, <span class="va">b</span><span class="op">$</span><span class="va">lambdaF</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">fcvl</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">bbmin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">bb</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">bb</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/filled.contour.html" class="external-link">filled.contour</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">lambdaF</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">fcvl</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">heat.colors</span>,</span></span>
<span class="r-in"><span>               plot.axes <span class="op">=</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">bmin</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">bmin</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>;</span></span>
<span class="r-in"><span>                            <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">bbmin</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">bbmin</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span><span class="st">"purple"</span><span class="op">)</span>;</span></span>
<span class="r-in"><span>                            <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">}</span>,</span></span>
<span class="r-in"><span>               xlab <span class="op">=</span> <span class="st">"lambda"</span>, ylab <span class="op">=</span> <span class="st">"lambdaF"</span>, main <span class="op">=</span> <span class="st">"Approximate LOOCV"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># Arbitrary penalty graphs</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate some new high-dimensional data and a 2 by 2 factorial design</span></span></span>
<span class="r-in"><span><span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">5</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>Factor1 <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, Factor2 <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Ylist</span> <span class="op">&lt;-</span> <span class="fu"><a href="createS.html">createS</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">ns</span>, p <span class="op">=</span> <span class="fl">4</span>, dataset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Tlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">Ylist</span>, <span class="va">covML</span><span class="op">)</span>, <span class="va">default.target</span>, type <span class="op">=</span> <span class="st">"Null"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Construct penalty matrix</span></span></span>
<span class="r-in"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="default.penalty.html">default.penalty</a></span><span class="op">(</span><span class="va">df</span>, type <span class="op">=</span> <span class="st">"CartesianUnequal"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find optimal parameters,</span></span></span>
<span class="r-in"><span><span class="co"># Using optim with method "Nelder-Mead" with "special" LOOCV</span></span></span>
<span class="r-in"><span><span class="va">ans1</span> <span class="op">&lt;-</span> <span class="fu">optPenalty.fused</span><span class="op">(</span><span class="va">Ylist</span>, <span class="va">Tlist</span>, lambda <span class="op">=</span> <span class="va">lambda</span>,</span></span>
<span class="r-in"><span>                         cv.method <span class="op">=</span> <span class="st">"sLOOCV"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ans1</span><span class="op">$</span><span class="va">lambda.unique</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># By approximate LOOCV using optim with method "BFGS"</span></span></span>
<span class="r-in"><span><span class="va">ans2</span> <span class="op">&lt;-</span> <span class="fu">optPenalty.fused</span><span class="op">(</span><span class="va">Ylist</span>, <span class="va">Tlist</span>, lambda <span class="op">=</span> <span class="va">lambda</span>,</span></span>
<span class="r-in"><span>                         cv.method <span class="op">=</span> <span class="st">"aLOOCV"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                         method <span class="op">=</span> <span class="st">"BFGS"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ans2</span><span class="op">$</span><span class="va">lambda.unique</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># By LOOCV using nlm</span></span></span>
<span class="r-in"><span><span class="va">lambda.init</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lambda.init</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">ans3</span> <span class="op">&lt;-</span> <span class="fu">optPenalty.fused</span><span class="op">(</span><span class="va">Ylist</span>, <span class="va">Tlist</span>, lambda <span class="op">=</span> <span class="va">lambda</span>,</span></span>
<span class="r-in"><span>                         lambda.init <span class="op">=</span> <span class="va">lambda.init</span>,</span></span>
<span class="r-in"><span>                         cv.method <span class="op">=</span> <span class="st">"LOOCV"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                         optimizer <span class="op">=</span> <span class="st">"nlm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ans3</span><span class="op">$</span><span class="va">lambda.unique</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Quite different results!</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># Arbitrary penalty graphs with fixed penalties!</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate some new high-dimensional data and a 2 by 2 factorial design</span></span></span>
<span class="r-in"><span><span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>DS <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, ER <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Ylist</span> <span class="op">&lt;-</span> <span class="fu"><a href="createS.html">createS</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">ns</span>, p <span class="op">=</span> <span class="fl">4</span>, dataset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Tlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">Ylist</span>, <span class="va">covML</span><span class="op">)</span>, <span class="va">default.target</span>, type <span class="op">=</span> <span class="st">"Null"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="default.penalty.html">default.penalty</a></span><span class="op">(</span><span class="va">df</span>, type <span class="op">=</span> <span class="st">"Tensor"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span>  <span class="co"># Say we want to penalize the pair (1,2) with strength 2.1;</span></span></span>
<span class="r-in"><span><span class="va">lambda</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">lambda</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2.1</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specifiying starting values is also possible:</span></span></span>
<span class="r-in"><span><span class="va">init</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ns</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">init</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">init</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2.1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">optPenalty.fused</span><span class="op">(</span><span class="va">Ylist</span>, <span class="va">Tlist</span>, lambda <span class="op">=</span> <span class="va">lambda</span>, lambda.init <span class="op">=</span> <span class="va">init</span>,</span></span>
<span class="r-in"><span>                        cv.method <span class="op">=</span> <span class="st">"aLOOCV"</span>, optimizer <span class="op">=</span> <span class="st">"nlm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Carel F.W. Peeters, Anders Ellern Bilgrau, Wessel N. van Wieringen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

