<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Visualize the spectral condition number against the regularization parameter — CNplot • rags2ridges</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Visualize the spectral condition number against the regularization parameter — CNplot"><meta property="og:description" content="Function that visualizes the spectral condition number of the regularized
precision matrix against the domain of the regularization parameter. The
function can be used to heuristically determine an acceptable (minimal)
value for the penalty parameter."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rags2ridges</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/rags2ridges.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/CFWP/rags2ridges/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Visualize the spectral condition number against the regularization parameter</h1>
    <small class="dont-index">Source: <a href="https://github.com/CFWP/rags2ridges/blob/HEAD/R/rags2ridges.R" class="external-link"><code>R/rags2ridges.R</code></a></small>
    <div class="hidden name"><code>CNplot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function that visualizes the spectral condition number of the regularized
precision matrix against the domain of the regularization parameter. The
function can be used to heuristically determine an acceptable (minimal)
value for the penalty parameter.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">CNplot</span><span class="op">(</span>
  <span class="va">S</span>,
  <span class="va">lambdaMin</span>,
  <span class="va">lambdaMax</span>,
  <span class="va">step</span>,
  type <span class="op">=</span> <span class="st">"Alt"</span>,
  target <span class="op">=</span> <span class="fu"><a href="default.target.html">default.target</a></span><span class="op">(</span><span class="va">S</span>, type <span class="op">=</span> <span class="st">"DUPV"</span><span class="op">)</span>,
  norm <span class="op">=</span> <span class="st">"2"</span>,
  Iaids <span class="op">=</span> <span class="cn">FALSE</span>,
  vertical <span class="op">=</span> <span class="cn">FALSE</span>,
  value <span class="op">=</span> <span class="fl">1e-100</span>,
  main <span class="op">=</span> <span class="st">""</span>,
  nOutput <span class="op">=</span> <span class="cn">FALSE</span>,
  verbose <span class="op">=</span> <span class="cn">TRUE</span>,
  suppressChecks <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>S</dt>
<dd><p>Sample covariance <code>matrix</code>.</p></dd>
<dt>lambdaMin</dt>
<dd><p>A <code>numeric</code> giving the minimum value for the penalty
parameter.</p></dd>
<dt>lambdaMax</dt>
<dd><p>A <code>numeric</code> giving the maximum value for the penalty
parameter.</p></dd>
<dt>step</dt>
<dd><p>An <code>integer</code> determining the number of steps in moving
through the grid [<code>lambdaMin</code>, <code>lambdaMax</code>].</p></dd>
<dt>type</dt>
<dd><p>A <code>character</code> indicating the type of ridge estimator to be
used. Must be one of: "Alt", "ArchI", "ArchII".</p></dd>
<dt>target</dt>
<dd><p>A target <code>matrix</code> (in precision terms) for Type I ridge
estimators.</p></dd>
<dt>norm</dt>
<dd><p>A <code>character</code> indicating the norm under which the condition
number is to be calculated/estimated. Must be one of: "1", "2".</p></dd>
<dt>Iaids</dt>
<dd><p>A <code>logical</code> indicating if the basic condition number plot
should be amended with interpretational aids.</p></dd>
<dt>vertical</dt>
<dd><p>A <code>logical</code> indicating if output graph should come with
a vertical line at a pre-specified value for the penalty parameter.</p></dd>
<dt>value</dt>
<dd><p>A <code>numeric</code> indicating a pre-specified value for the
penalty parameter.</p></dd>
<dt>main</dt>
<dd><p>A <code>character</code> with which to specify the main title of the
output graph.</p></dd>
<dt>nOutput</dt>
<dd><p>A <code>logical</code> indicating if numeric output should be
returned.</p></dd>
<dt>verbose</dt>
<dd><p>A <code>logical</code> indicating if information on progress should
be printed on screen.</p></dd>
<dt>suppressChecks</dt>
<dd><p>A <code>logical</code> indicating if the input checks should
be suppressed.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The function returns a graph. If <code>nOutput = TRUE</code> the function
also returns an object of class <code>list</code>:</p>
<dl><dt>lambdas</dt>
<dd><p>A <code>numeric</code>
vector representing all values of the penalty parameter for which the
condition number was calculated. The values of the penalty parameter are
log-equidistant.</p></dd>
<dt>conditionNumbers</dt>
<dd><p>A <code>numeric</code> vector containing
the condition number for each value of the penalty parameter given in
<code>lambdas</code>.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Under certain target choices the proposed ridge estimators (see
<code><a href="ridgeP.html">ridgeP</a></code>) are rotation equivariant, i.e., the eigenvectors of
\(\mathbf{S}\) are left intact. Such rotation equivariant situations help
to understand the effect of the ridge penalty on the precision estimate: The
effect can be understood in terms of shrinkage of the eigenvalues of the
unpenalized precision estimate \(\mathbf{S}^{-1}\). Maximum shrinkage
implies that all eigenvalues are forced to be equal (in the rotation
equivariant situation). The spectral condition number w.r.t. inversion
(ratio of maximum to minimum eigenvalue) of the regularized precision matrix
may function as a heuristic in determining the (minimal) value of the
penalty parameter. A matrix with a high condition number is near-singular
(the relative distance to the set of singular matrices equals the reciprocal
of the condition number; Demmel, 1987) and its inversion is numerically
unstable. Such a matrix is said to be ill-conditioned. Numerically,
ill-conditioning will mean that small changes in the penalty parameter lead
to dramatic changes in the condition number. From a numerical point of view
one can thus track the domain of the penalty parameter for which the
regularized precision matrix is ill-conditioned. When plotting the condition
number against the (domain of the) penalty parameter, there is a point of
relative stabilization (when working in the \(p &gt; n\) situation) that can
be characterized by a leveling-off of the acceleration along the curve when
plotting the condition number against the (chosen) domain of the penalty
parameter. This suggest the following fast heuristic for determining the
(minimal) value of the penalty parameter: The value of the penalty parameter
for which the spectral condition number starts to stabilize may be termed an
acceptable (minimal) value.</p>
<p>The function outputs a graph of the (spectral) matrix condition number over
the domain [<code>lambdaMin</code>, <code>lambdaMax</code>]. When <code>norm = "2"</code> the
spectral condition number is calculated. It is determined by exact
calculation using the spectral decomposition. For most purposes this exact
calculation is fast enough, especially when considering rotation equivariant
situations (see <code><a href="ridgeP.html">ridgeP</a></code>). For such situations the amenities for
fast eigenvalue calculation as provided by
<a href="https://CRAN.R-project.org/package=RSpectra" class="external-link">RSpectra</a> are used
internally. When exact computation of the spectral condition number is
deemed too costly one may approximate the computationally friendly
L1-condition number. This approximation is accessed through the
<a href="https://rdrr.io/r/base/kappa.html" class="external-link">rcond</a> function (Anderson et al. 1999).</p>
<p>When <code>Iaids = TRUE</code> the basic condition number plot is amended/enhanced
with two additional plots (over the same domain of the penalty parameter as
the basic plot): The approximate loss in digits of accuracy (for the
operation of inversion) and an approximation to the second-order derivative
of the curvature in the basic plot. These interpretational aids can enhance
interpretation of the basic condition number plot and may support choosing a
value for the penalty parameter (see Peeters, van de Wiel, &amp; van Wieringen,
2016). When <code>vertical = TRUE</code> a vertical line is added at the constant
<code>value</code>. This option can be used to assess if the optimal penalty
obtained by, e.g., the routines <code><a href="optPenalty.LOOCV.html">optPenalty.LOOCV</a></code> or
<code><a href="optPenalty.aLOOCV.html">optPenalty.aLOOCV</a></code>, has led to a precision estimate that is
well-conditioned.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The condition number of a (regularized) covariance matrix is
equivalent to the condition number of its corresponding inverse, the
(regularized) precision matrix. Please note that the <code>target</code> argument
(for Type I ridge estimators) is assumed to be specified in precision terms.
In case one is interested in the condition number of a Type I estimator
under a covariance target, say \(\mathbf{\Gamma}\), then just specify
<code>target = solve</code>(\(\mathbf{\Gamma}\)).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Anderson, E, Bai, Z., ..., Sorenson, D. (1999). LAPACK Users'
Guide (3rd ed.). Philadelphia, PA, USA: Society for Industrial and Applied
Mathematics.</p>
<p>Demmel, J.W. (1987). On condition numbers and the distance to the nearest
ill-posed problem. Numerische Mathematik, 51: 251--289.</p>
<p>Peeters, C.F.W., van de Wiel, M.A., &amp; van Wieringen, W.N. (2020). The
spectral condition number plot for regularization parameter evaluation.
Computational Statistics, 35: 629--646.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="covML.html">covML</a></code>, <code><a href="ridgeP.html">ridgeP</a></code>,
<code><a href="optPenalty.LOOCV.html">optPenalty.LOOCV</a></code>, <code><a href="optPenalty.aLOOCV.html">optPenalty.aLOOCV</a></code>,
<code><a href="default.target.html">default.target</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Carel F.W. Peeters &lt;carel.peeters@wur.nl&gt;</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## Obtain some (high-dimensional) data</span></span>
<span class="r-in"><span class="va">p</span> <span class="op">=</span> <span class="fl">25</span></span>
<span class="r-in"><span class="va">n</span> <span class="op">=</span> <span class="fl">10</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">333</span><span class="op">)</span></span>
<span class="r-in"><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span> <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span></span>
<span class="r-in"><span class="va">Cx</span> <span class="op">&lt;-</span> <span class="fu"><a href="covML.html">covML</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Assess spectral condition number across grid of penalty parameter</span></span>
<span class="r-in"><span class="fu">CNplot</span><span class="op">(</span><span class="va">Cx</span>, lambdaMin <span class="op">=</span> <span class="fl">.0001</span>, lambdaMax <span class="op">=</span> <span class="fl">50</span>, step <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Perform input checks... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating spectral condition numbers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Plotting... </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Include interpretational aids</span></span>
<span class="r-in"><span class="fu">CNplot</span><span class="op">(</span><span class="va">Cx</span>, lambdaMin <span class="op">=</span> <span class="fl">.0001</span>, lambdaMax <span class="op">=</span> <span class="fl">50</span>, step <span class="op">=</span> <span class="fl">1000</span>, Iaids <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Perform input checks... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating spectral condition numbers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating interpretational aids... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Plotting... </span>
<span class="r-plt img"><img src="CNplot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Carel F.W. Peeters, Anders Ellern Bilgrau, Wessel N. van Wieringen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

