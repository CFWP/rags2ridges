<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Ridge estimation for high-dimensional precision matrices with known chordal
support — ridgePchordal • rags2ridges</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Ridge estimation for high-dimensional precision matrices with known chordal
support — ridgePchordal" />
<meta property="og:description" content="Calculates various ridge estimators for high-dimensional
precision matrices with known support. This support should form a chordal
graph. If the provided support is not chordal, the function makes it so." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rags2ridges</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rags2ridges.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/CFWP/rags2ridges/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Ridge estimation for high-dimensional precision matrices with known chordal
support</h1>
    <small class="dont-index">Source: <a href='https://github.com/CFWP/rags2ridges/blob/master/R/rags2ridgesVariants.r'><code>R/rags2ridgesVariants.r</code></a></small>
    <div class="hidden name"><code>ridgePchordal.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates various ridge estimators for high-dimensional
precision matrices with known support. This support should form a chordal
graph. If the provided support is not chordal, the function makes it so.</p>
    </div>

    <pre class="usage"><span class='fu'>ridgePchordal</span><span class='op'>(</span>
  <span class='va'>S</span>,
  <span class='va'>lambda</span>,
  <span class='va'>zeros</span>,
  cliques <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  separators <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  target <span class='op'>=</span> <span class='fu'><a href='default.target.html'>default.target</a></span><span class='op'>(</span><span class='va'>S</span><span class='op'>)</span>,
  type <span class='op'>=</span> <span class='st'>"Alt"</span>,
  optimizer <span class='op'>=</span> <span class='st'>"nlm"</span>,
  grad <span class='op'>=</span> <span class='cn'>FALSE</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>S</th>
      <td><p>Sample covariance <code>matrix</code>.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>A <code>numeric</code> representing the value of the penalty
parameter.</p></td>
    </tr>
    <tr>
      <th>zeros</th>
      <td><p><code>Matrix</code> with indices of entries of the adjacency matrix
that are zero. The matrix comprises two columns, each row corresponding to
an entry of the adjacency matrix. The first column contains the row indices
and the second the column indices. The specified graph should be undirected
and decomposable. If not, use the <code><a href='support4ridgeP.html'>support4ridgeP</a></code> to
symmetrize and triangulate. This is done automatically if <code>cliques</code>
and <code>separators</code> arguments are empty lists (and the then employed
<code>zeros</code>-object may differ from the one provided as input).</p></td>
    </tr>
    <tr>
      <th>cliques</th>
      <td><p>A <code>list</code>-object containing the node indices per clique as
obtained from the <code><a href='support4ridgeP.html'>support4ridgeP</a></code>-function.</p></td>
    </tr>
    <tr>
      <th>separators</th>
      <td><p>A <code>list</code>-object containing the node indices per
separator as obtained from the <code><a href='support4ridgeP.html'>support4ridgeP</a></code>-function.</p></td>
    </tr>
    <tr>
      <th>target</th>
      <td><p>A target <code>matrix</code> (in precision terms) for Type I ridge
estimators.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>A <code>character</code> indicating the type of ridge estimator to be
used. Must be one of: <code>Alt</code> (default), <code>ArchI</code>, <code>ArchII</code>.</p></td>
    </tr>
    <tr>
      <th>optimizer</th>
      <td><p>A <code>character</code> (either <code>nlm</code> (default) or
<code>optim</code>) specifying which optimization function should be used:
<code><a href='https://rdrr.io/r/stats/nlm.html'>nlm</a></code> (default) or <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code>?</p></td>
    </tr>
    <tr>
      <th>grad</th>
      <td><p>A <code>logical</code> indicator: should, next to the precision matrix
estimate, also the gradient be returned?</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A <code>logical</code> indicator: should intermediate output be
printed on the screen?</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed on to either
<code><a href='https://rdrr.io/r/stats/nlm.html'>nlm</a></code> or <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <code>grad=FALSE</code>, the function returns a regularized precision
<code>matrix</code> with specified chordal sparsity structure.</p>
<p>If <code>grad=TRUE</code>, a list is returned comprising of <em>i)</em> the
estimated precision matrix, and <em>ii)</em> the gradients at the initial and
at the optimal (if reached) value. The gradient is returned and it can be
checked whether it is indeed (close to) zero at the optimum.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Sister function to the <code><a href='ridgeP.html'>ridgeP</a></code>-function, incorporating a chordal
zero structure of the precision matrix.</p>
<p>The loss function for <code>type="ArchII"</code> is:
  $$
    \log(| \mathbf{\Omega} |) - \mbox{tr}( \mathbf{S} \mathbf{\Omega} ) +
    \lambda
    \big\{
      \log(| \mathbf{\Omega} |) -
      \mbox{tr}[ (\mathbf{S} + (1+\lambda) \mathbf{I}_{p \times p})
      \mathbf{\Omega} ]
    \big\}.
  $$
For <code>type="ArchI"</code> it is:
  $$
    (1-\lambda)
    \big[ \log(| \mathbf{\Omega} |) -
          \mbox{tr}( \mathbf{S} \mathbf{\Omega} ) \big] +
    \lambda \big[ \log(| \mathbf{\Omega} |) - \mbox{tr}( \mathbf{\Omega} )
    \big],
  $$
which is obtained from:
  $$
    \log(| \mathbf{\Omega} |) - \mbox{tr}( \mathbf{S} \mathbf{\Omega} ) +
    \nu \big[ \log(| \mathbf{\Omega} |) - \mbox{tr}( \mathbf{\Omega} ) \big]
  $$
by division of \((1+\nu)\) and writing \(\lambda = \nu / (1 + \nu)\).</p>
<p>An explicit expression for the minimizer of the loss functions implied by the
archetypal ridge estimators (<code>type="ArchI"</code> and <code>type="ArchII"</code>)
exists. For the simple case in which the graph decomposes into cliques
\(\mathcal{C}_1\), \(\mathcal{C}_2\) and separator \(\mathcal{S}\) the
estimator is:
  $$
    \widehat{\mathbf{\Omega}}  =
    \left(
      \begin{array}{lll}
      \, [\widehat{\mathbf{\Omega}}^{({\mathcal{C}_1})}]_{\mathcal{C}_1 \setminus \mathcal{S}, \mathcal{C}_1 \setminus \mathcal{S}} &amp; [\widehat{\mathbf{\Omega}}^{({\mathcal{C}_1})}]_{\mathcal{C}_1 \setminus \mathcal{S}, \mathcal{S}} &amp; \mathbf{0}_{|\mathcal{C}_1 \setminus \mathcal{S}| \times |\mathcal{C}_2 \setminus \mathcal{S}|}
      \\
      \, [\widehat{\mathbf{\Omega}}^{(\mathcal{C}_1)}]_{\mathcal{S}, \mathcal{C}_1 \setminus \mathcal{S}} &amp; [\widehat{\mathbf{\Omega}}^{({\mathcal{C}_1})}]_{\mathcal{S}, \mathcal{S}} + [\widehat{\mathbf{\Omega}}^{({\mathcal{C}_2})}]_{\mathcal{S}, \mathcal{S}} - \widehat{\mathbf{\Omega}}^{(\mathcal{S})} &amp; [\widehat{\mathbf{\Omega}}^{({\mathcal{C}_2})}]_{\mathcal{S}, \mathcal{C}_2 \setminus \mathcal{S}}
      \\
      \, \mathbf{0}_{|\mathcal{C}_2 \setminus \mathcal{S}| \times |\mathcal{C}_1 \setminus \mathcal{S}|} &amp; [\widehat{\mathbf{\Omega}}^{({\mathcal{C}_2})}]_{\mathcal{C}_2 \setminus \mathcal{S}, \mathcal{S}} &amp; [\widehat{\mathbf{\Omega}}^{({\mathcal{C}_2})}]_{\mathcal{C}_2 \setminus \mathcal{S}, \mathcal{C}_2 \setminus \mathcal{S}}
      \end{array}
      \right),
  $$
where \(\widehat{\mathbf{\Omega}}^{({\mathcal{C}_1})}\),
\(\widehat{\mathbf{\Omega}}^{({\mathcal{C}_1})}\) and
\(\widehat{\mathbf{\Omega}}^{({\mathcal{S}})}\) are the marginal ridge ML
covariance estimators for cliques \(\mathcal{C}_1\), \(\mathcal{C}_2\)
and separator \(\mathcal{S}\). The general form of the estimator,
implemented here, is analogous to that provided in Proposition 5.9 of
Lauritzen (2004). The proof that this estimator indeed optimizes the
corresponding loss function is fully analogous to that of Proposition 5.6 of
Lauritzen (2004).</p>
<p>In case, <code>type="Alt"</code> no explicit expression of the maximizer of the
ridge penalized log-likelihood exists. However, an initial estimator
analogous to that for <code>type="ArchI"</code> and <code>type="ArchII"</code> can be
defined. In various boundary cases (\(\lambda=0\), \(\lambda=\infty\),
and \(\mathcal{S} = \emptyset\)) this initial estimator actually optimizes
the loss function. In general, however, it does not. Nevertheless, it
functions as well-educated guess for any Newton-like optimization method:
convergence is usually achieved quickly. The Newton-like procedure optimizes
an unconstrained problem equivalent to that of the penalized log-likelihood
with known zeros for the precision matrix (see Dahl <em>et al</em>., 2005 for
details).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Dahl, J., Roychowdhury, V., Vandenberghe, L. (2005), "Maximum
likelihood estimation of Gaussian graphical models: numerical implementation
and topology selection", Technical report, UCLA, 2005.</p>
<p>Lauritzen, S.L. (2004). <em>Graphical Models</em>. Oxford University Press.</p>
<p>Miok, V., Wilting, S.M., Van Wieringen, W.N. (2016), "Ridge estimation of
the VAR(1) model and its time series chain graph from multivariate
time-course omics data", <em>Biometrical Journal</em>, 59(1), 172-191.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='ridgeP.html'>ridgeP</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Wessel N. van Wieringen.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># obtain some (high-dimensional) data</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fl'>8</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>100</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>333</span><span class='op'>)</span>
<span class='va'>Y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>*</span><span class='va'>p</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='va'>n</span>, ncol <span class='op'>=</span> <span class='va'>p</span><span class='op'>)</span>

<span class='co'># define zero structure</span>
<span class='va'>S</span> <span class='op'>&lt;-</span> <span class='fu'><a href='covML.html'>covML</a></span><span class='op'>(</span><span class='va'>Y</span><span class='op'>)</span>
<span class='va'>S</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='fl'>6</span><span class='op'>:</span><span class='fl'>8</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
<span class='va'>S</span><span class='op'>[</span><span class='fl'>6</span><span class='op'>:</span><span class='fl'>8</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
<span class='va'>zeros</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>S</span><span class='op'>==</span><span class='fl'>0</span>, arr.ind<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># obtain (triangulated) support info</span>
<span class='va'>supportP</span> <span class='op'>&lt;-</span> <span class='fu'><a href='support4ridgeP.html'>support4ridgeP</a></span><span class='op'>(</span>nNodes<span class='op'>=</span><span class='va'>p</span>, zeros<span class='op'>=</span><span class='va'>zeros</span><span class='op'>)</span>

<span class='co'># estimate precision matrix with known (triangulated) support</span>
<span class='va'>Phat</span> <span class='op'>&lt;-</span> <span class='fu'>ridgePchordal</span><span class='op'>(</span><span class='va'>S</span>, <span class='fl'>0.1</span>, zeros<span class='op'>=</span><span class='va'>supportP</span><span class='op'>$</span><span class='va'>zeros</span>,
  cliques<span class='op'>=</span><span class='va'>supportP</span><span class='op'>$</span><span class='va'>cliques</span>, separators<span class='op'>=</span><span class='va'>supportP</span><span class='op'>$</span><span class='va'>separators</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   
#&gt; Progress report .... 
#&gt; -&gt; ---------------------------------------------------------------------- 
#&gt; -&gt; optimization over                   : 27 out of 36 unique 
#&gt; -&gt;                                       parameters (75%) 
#&gt; -&gt; cond. number of initial estimate    : 1.95 (if &gt;&gt; 100, consider 
#&gt; -&gt;                                       larger values of lambda) 
#&gt; -&gt; # graph components                  : 1 (optimization per component) 
#&gt; -&gt; optimization per component          :  
#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |......................................................................| 100%
#&gt; 
#&gt; -&gt; estimation done ... 
#&gt; -&gt; formatting output ... 
#&gt; -&gt; overall summary .... 
#&gt; -&gt; initial pen. log-likelihood         : -7.45199157 
#&gt; -&gt; optimized pen. log-likelihood       : -7.45199081 
#&gt; -&gt; optimization                        : converged (most likely) 
#&gt; -&gt;                                       for all components 
#&gt; -&gt; ---------------------------------------------------------------------- </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Carel F.W. Peeters, Anders Ellern Bilgrau, Wessel N. van Wieringen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


