<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate sample covariances or datasets — createS • rags2ridges</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simulate sample covariances or datasets — createS" />
<meta property="og:description" content="Simulate data from a p-dimensional (zero-mean) gaussian graphical model (GGM)
with a specified (or random) topology and return the sample covariance matrix
or matrices. Can also return the original simulated data or underlying
precision matrix." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rags2ridges</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rags2ridges.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/CFWP/rags2ridges/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate sample covariances or datasets</h1>
    <small class="dont-index">Source: <a href='https://github.com/CFWP/rags2ridges/blob/master/R/rags2ridgesFused.R'><code>R/rags2ridgesFused.R</code></a></small>
    <div class="hidden name"><code>createS.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulate data from a p-dimensional (zero-mean) gaussian graphical model (GGM)
with a specified (or random) topology and return the sample covariance matrix
or matrices. Can also return the original simulated data or underlying
precision matrix.</p>
    </div>

    <pre class="usage"><span class='fu'>createS</span><span class='op'>(</span>
  <span class='va'>n</span>,
  <span class='va'>p</span>,
  topology <span class='op'>=</span> <span class='st'>"identity"</span>,
  dataset <span class='op'>=</span> <span class='cn'>FALSE</span>,
  precision <span class='op'>=</span> <span class='cn'>FALSE</span>,
  nonzero <span class='op'>=</span> <span class='fl'>0.25</span>,
  m <span class='op'>=</span> <span class='fl'>1L</span>,
  banded.n <span class='op'>=</span> <span class='fl'>2L</span>,
  invwishart <span class='op'>=</span> <span class='cn'>FALSE</span>,
  nu <span class='op'>=</span> <span class='va'>p</span> <span class='op'>+</span> <span class='fl'>1</span>,
  <span class='va'>Plist</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>n</th>
      <td><p>A <code>numeric</code> vector giving number of samples. If the length is
larger than 1, the covariance matrices are returned as a list.</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>A <code>numeric</code> of length 1 giving the dimension of the
samples/covariance.</p></td>
    </tr>
    <tr>
      <th>topology</th>
      <td><p>character. The topology to use for the simulations. See the
details.</p></td>
    </tr>
    <tr>
      <th>dataset</th>
      <td><p>A <code>logical</code> value specifying whether the sample
covariance or the simulated data itself should be returned.</p></td>
    </tr>
    <tr>
      <th>precision</th>
      <td><p>A <code>logical</code> value. If <code>TRUE</code> the constructed
precision matrix is returned.</p></td>
    </tr>
    <tr>
      <th>nonzero</th>
      <td><p>A <code>numeric</code> of length 1 giving the value of the nonzero
entries used in some topologies.</p></td>
    </tr>
    <tr>
      <th>m</th>
      <td><p>A <code>integer</code> giving the number of blocks (i.e. conditionally
independent components) to create. If <code>m</code> is greater than 1, then the
given <code>topology</code> is used on <code>m</code> blocks of approximately equal
size.</p></td>
    </tr>
    <tr>
      <th>banded.n</th>
      <td><p>A <code>integer</code> of length one giving the number of bands.
Only used if <code>topology</code> is one of <code>"banded"</code>,
<code>"small-world"</code>, or <code>"Watts-Strogatz"</code>.</p></td>
    </tr>
    <tr>
      <th>invwishart</th>
      <td><p><code>logical</code>. If <code>TRUE</code> the constructed precision
matrix is used as the scale matrix of an inverse Wishart distribution and
class covariance matrices are drawn from this distribution.</p></td>
    </tr>
    <tr>
      <th>nu</th>
      <td><p><code>numeric</code> greater than <code>p + 1</code> giving the degrees of
freedom in the inverse Wishart distribution.  A large <code>nu</code> implies
high class homogeneity.  A small <code>nu</code> near <code>p + 1</code> implies high
class heterogeneity.</p></td>
    </tr>
    <tr>
      <th>Plist</th>
      <td><p>An optional <code>list</code> of <code>numeric</code> matrices giving the
precision matrices to simulate from. Useful when random matrices have
already been generated by setting <code>precision = TRUE</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The returned type is dependent on <code>n</code> and <code>covariance</code>. The
  function generally returns a <code>list</code> of <code>numeric</code> matrices with
  the same length as <code>n</code>. If <code>covariance</code> is <code>FALSE</code> the
  simulated datasets with size <code>n[i]</code> by <code>p</code> are given in the
  <code>i</code> entry of the output. If <code>covariance</code> is <code>TRUE</code> the
  <code>p</code> by <code>p</code> sample covariances of the datasets are given. When
  <code>n</code> has length 1 the <code>list</code> structure is dropped and the matrix
  is returned.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The data is simulated from a zero-mean <code>p</code>-dimensional multivariate
gaussian distribution with some precision matrix determined by the argument
<code>topology</code> which defines the GGM. If <code>precision</code> is <code>TRUE</code> the
population precision matrix is returned. This is useful to see what the
actual would-be-used precision matrices are. The available values of
<code>topology</code> are described below. Unless otherwise stated the diagonal
entries are always one. If <code>m</code> is 2 or greater block diagonal precision
matrices are constructed and used.</p><ul>
<li><p><code>"identity"</code>: uses
the identity matrix (<code><a href='https://rdrr.io/r/base/diag.html'>diag(p)</a></code>) as precision matrix.  Corresponds to no
conditional dependencies.</p></li>
<li><p><code>"star"</code>: simulate from a star
topology. Within each block the first node is selected as the "hub". The
off-diagonal entries \((1,j)\) and \((j,1)\) values taper off with the
value \(1/(j + 1)\).</p></li>
<li><p><code>"clique"</code>: simulate from clique topology
where each block is a complete graph with off-diagonal elements equal to
<code>nonzero</code>.</p></li>
<li><p><code>"complete"</code>: alias for (and identical to)
<code>"clique"</code>.</p></li>
<li><p><code>"chain"</code>: simulate from a chain topology where
the precision matrix is a tridiagonal matrix with off-diagonal elements (in
each block) given by argument <code>nonzero</code>.</p></li>
<li><p><code>"banded"</code>:
precision elements <code>(i,j)</code> are given by \(1/(|i-j|+1)\) if \(|i-j|\)
is less than or equal to <code>banded.n</code> and zero otherwise.</p></li>
<li><p><code>"scale-free"</code>: The non-zero pattern of each block is generated by a
Barabassi random graph. Non-zero off-diagonal values are given by
<code>nonzero</code>.  Gives are very "hubby" network.</p></li>
<li><p><code>"Barabassi"</code>:
alias for <code>"scale-free"</code>.</p></li>
<li><p><code>"small-world"</code>: The non-zero
pattern of each block is generated by a 1-dimensional Watts-Strogatz random
graph with <code>banded.n</code> starting neighbors and \(5\%\) probability of
rewiring.  Non-zero off-diagonal values are given by <code>nonzero</code>. Gives
are very "bandy" network.</p></li>
<li><p><code>"Watts-Strogatz"</code>: alias for
<code>"small-world"</code></p></li>
<li><p><code>"random-graph"</code>: The non-zero pattern of
each block is generated by a Erdos-Renyi random graph where each edge is
present with probability \(1/p\).  Non-zero off-diagonal values are given
by <code>nonzero</code>.</p></li>
<li><p><code>"Erdos-Renyi"</code>: alias for
<code>"random-graph"</code></p></li>
</ul><p>When <code>n</code> has length greater than 1, the datasets
are generated i.i.d. given the topology and number of blocks.</p>
<p>Arguments <code>invwishart</code> and <code>nu</code> allows for introducing class
homogeneity. Large values of <code>nu</code> imply high class homogeneity.
<code>nu</code> must be greater than <code>p + 1</code>. More precisely, if
<code>invwishart == TRUE</code> then the constructed precision matrix is used as
the scale parameter in an inverse Wishart distribution with <code>nu</code> degrees
of freedom. Each class covariance is distributed according to this inverse
Wishart and independent.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Anders E. Bilgrau, Carel F.W. Peeters &lt;cf.peeters@vumc.nl&gt;, Wessel
  N. van Wieringen</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Generate some simple sample covariance matrices</span>
<span class='fu'>createS</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, p <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</div><div class='output co'>#&gt;              A            B          C
#&gt; A  0.714338666 -0.008603045 -0.4495777
#&gt; B -0.008603045  0.848783685 -0.4070938
#&gt; C -0.449577686 -0.407093834  1.6648221</div><div class='input'><span class='fu'>createS</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span><span class='op'>)</span>, p <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $class1
#&gt;             A           B           C
#&gt; A  0.23541993 -0.06808345 -0.09331714
#&gt; B -0.06808345  0.02188217  0.02633239
#&gt; C -0.09331714  0.02633239  0.03718524
#&gt; 
#&gt; $class2
#&gt;           A           B           C
#&gt; A 0.4048721  0.18554770  0.15656767
#&gt; B 0.1855477  0.11035641 -0.03908228
#&gt; C 0.1565677 -0.03908228  0.59124579
#&gt; 
#&gt; $class3
#&gt;            A          B           C
#&gt; A  0.9965404 0.26490592 -0.18057305
#&gt; B  0.2649059 0.43924828  0.03874123
#&gt; C -0.1805730 0.03874123  1.94661771
#&gt; </div><div class='input'><span class='fu'>createS</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>32</span>, <span class='fl'>55</span><span class='op'>)</span>, p <span class='op'>=</span> <span class='fl'>7</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $class1
#&gt;             A           B           C           D           E           F
#&gt; A  0.63178208  0.06467505  0.19670069  0.06289789  0.04188822 -0.19040730
#&gt; B  0.06467505  0.93135667  0.08449495  0.02381718 -0.22198857 -0.02349797
#&gt; C  0.19670069  0.08449495  0.93995769 -0.34139993  0.14346997  0.33424291
#&gt; D  0.06289789  0.02381718 -0.34139993  0.73176859 -0.17331770 -0.21105145
#&gt; E  0.04188822 -0.22198857  0.14346997 -0.17331770  1.36921587  0.11591828
#&gt; F -0.19040730 -0.02349797  0.33424291 -0.21105145  0.11591828  0.81224374
#&gt; G -0.01227575 -0.03793069  0.10206489  0.18693117 -0.20170543  0.02724070
#&gt;             G
#&gt; A -0.01227575
#&gt; B -0.03793069
#&gt; C  0.10206489
#&gt; D  0.18693117
#&gt; E -0.20170543
#&gt; F  0.02724070
#&gt; G  0.56993517
#&gt; 
#&gt; $class2
#&gt;             A           B           C           D           E           F
#&gt; A  1.04034367 -0.23721483 -0.16969116  0.04907348 -0.07136711 -0.11950913
#&gt; B -0.23721483  0.96099733 -0.13451093 -0.14600484 -0.07506789  0.18548682
#&gt; C -0.16969116 -0.13451093  1.12555789 -0.18544152 -0.05878663  0.11898834
#&gt; D  0.04907348 -0.14600484 -0.18544152  0.93703353  0.11422203 -0.11126085
#&gt; E -0.07136711 -0.07506789 -0.05878663  0.11422203  0.82855277  0.02398115
#&gt; F -0.11950913  0.18548682  0.11898834 -0.11126085  0.02398115  0.99802168
#&gt; G -0.06728589  0.11392344  0.13948464  0.17997138  0.04343981 -0.28291270
#&gt;             G
#&gt; A -0.06728589
#&gt; B  0.11392344
#&gt; C  0.13948464
#&gt; D  0.17997138
#&gt; E  0.04343981
#&gt; F -0.28291270
#&gt; G  1.00373644
#&gt; </div><div class='input'>
<span class='co'>## Generate some datasets and not sample covariance matrices</span>
<span class='fu'>createS</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>4</span><span class='op'>)</span>, p <span class='op'>=</span> <span class='fl'>6</span>, dataset <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $class1
#&gt;                A          B          C          D          E          F
#&gt; [1,]  0.90493393  0.5602515 1.79739015  1.1985082  0.3703148 -1.0219351
#&gt; [2,] -0.06181858 -0.8432687 0.60311808  0.1489683 -1.9410410  0.5510601
#&gt; [3,] -0.81701756 -0.1890840 0.05481809 -0.2684883 -1.8716184 -1.1819590
#&gt; 
#&gt; $class2
#&gt;               A          B          C          D           E           F
#&gt; [1,] -1.9289744 -1.1150966  0.5732693 -0.9779805  0.93539734 -2.52598044
#&gt; [2,]  1.9132912 -1.6585732 -1.9060648 -1.5551617 -0.47828835  0.77125979
#&gt; [3,] -0.3644607 -0.3126735 -0.4776542  0.6235130 -0.35469283 -0.23236273
#&gt; [4,] -1.7555148  2.8456476  0.6439718 -0.2382009 -0.06902261  0.02795027
#&gt; </div><div class='input'>
<span class='co'>## Generate sample covariance matrices from other topologies:</span>
<span class='va'>A</span> <span class='op'>&lt;-</span> <span class='fu'>createS</span><span class='op'>(</span><span class='fl'>2000</span>, p <span class='op'>=</span> <span class='fl'>4</span>, topology <span class='op'>=</span> <span class='st'>"star"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/solve.html'>solve</a></span><span class='op'>(</span><span class='va'>A</span><span class='op'>)</span>, <span class='fl'>3</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       A     B     C     D
#&gt; A 0.958 0.464 0.334 0.270
#&gt; B 0.464 0.996 0.012 0.017
#&gt; C 0.334 0.012 0.955 0.016
#&gt; D 0.270 0.017 0.016 0.988</div><div class='input'><span class='va'>B</span> <span class='op'>&lt;-</span> <span class='fu'>createS</span><span class='op'>(</span><span class='fl'>2000</span>, p <span class='op'>=</span> <span class='fl'>4</span>, topology <span class='op'>=</span> <span class='st'>"banded"</span>, banded.n <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/solve.html'>solve</a></span><span class='op'>(</span><span class='va'>B</span><span class='op'>)</span>, <span class='fl'>3</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       A     B     C     D
#&gt; A 0.993 0.492 0.344 0.036
#&gt; B 0.492 0.990 0.482 0.323
#&gt; C 0.344 0.482 1.024 0.541
#&gt; D 0.036 0.323 0.541 1.024</div><div class='input'><span class='va'>C</span> <span class='op'>&lt;-</span> <span class='fu'>createS</span><span class='op'>(</span><span class='fl'>2000</span>, p <span class='op'>=</span> <span class='fl'>4</span>, topology <span class='op'>=</span> <span class='st'>"clique"</span><span class='op'>)</span>  <span class='co'># The complete graph (as m = 1)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/solve.html'>solve</a></span><span class='op'>(</span><span class='va'>C</span><span class='op'>)</span>, <span class='fl'>3</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       A     B     C     D
#&gt; A 1.009 0.265 0.252 0.235
#&gt; B 0.265 1.015 0.251 0.234
#&gt; C 0.252 0.251 0.996 0.295
#&gt; D 0.235 0.234 0.295 0.975</div><div class='input'><span class='va'>D</span> <span class='op'>&lt;-</span> <span class='fu'>createS</span><span class='op'>(</span><span class='fl'>2000</span>, p <span class='op'>=</span> <span class='fl'>4</span>, topology <span class='op'>=</span> <span class='st'>"chain"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/solve.html'>solve</a></span><span class='op'>(</span><span class='va'>D</span><span class='op'>)</span>, <span class='fl'>3</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        A     B      C     D
#&gt; A  1.042 0.261 -0.005 0.029
#&gt; B  0.261 0.963  0.255 0.044
#&gt; C -0.005 0.255  1.002 0.253
#&gt; D  0.029 0.044  0.253 0.983</div><div class='input'>
<span class='co'>## Generate smaple covariance matrices from block topologies:</span>
<span class='va'>C3</span> <span class='op'>&lt;-</span> <span class='fu'>createS</span><span class='op'>(</span><span class='fl'>2000</span>, p <span class='op'>=</span> <span class='fl'>10</span>, topology <span class='op'>=</span> <span class='st'>"clique"</span>, m <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/solve.html'>solve</a></span><span class='op'>(</span><span class='va'>C3</span><span class='op'>)</span>, <span class='fl'>1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     A   B   C   D   E   F   G   H   I   J
#&gt; A 1.0 0.3 0.3 0.0 0.0 0.0 0.0 0.0 0.0 0.0
#&gt; B 0.3 1.0 0.3 0.0 0.0 0.0 0.0 0.0 0.0 0.0
#&gt; C 0.3 0.3 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
#&gt; D 0.0 0.0 0.0 1.0 0.3 0.3 0.0 0.0 0.0 0.0
#&gt; E 0.0 0.0 0.0 0.3 1.0 0.2 0.0 0.0 0.0 0.0
#&gt; F 0.0 0.0 0.0 0.3 0.2 1.0 0.0 0.0 0.0 0.0
#&gt; G 0.0 0.0 0.0 0.0 0.0 0.0 1.0 0.3 0.2 0.3
#&gt; H 0.0 0.0 0.0 0.0 0.0 0.0 0.3 1.0 0.2 0.3
#&gt; I 0.0 0.0 0.0 0.0 0.0 0.0 0.2 0.2 1.0 0.3
#&gt; J 0.0 0.0 0.0 0.0 0.0 0.0 0.3 0.3 0.3 1.0</div><div class='input'><span class='va'>C5</span> <span class='op'>&lt;-</span> <span class='fu'>createS</span><span class='op'>(</span><span class='fl'>2000</span>, p <span class='op'>=</span> <span class='fl'>10</span>, topology <span class='op'>=</span> <span class='st'>"clique"</span>, m <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/solve.html'>solve</a></span><span class='op'>(</span><span class='va'>C5</span><span class='op'>)</span>, <span class='fl'>1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     A   B   C    D   E   F   G    H   I   J
#&gt; A 1.0 0.3 0.0  0.0 0.0 0.0 0.0  0.0 0.0 0.0
#&gt; B 0.3 1.1 0.0  0.0 0.0 0.0 0.0  0.0 0.0 0.0
#&gt; C 0.0 0.0 1.0  0.2 0.0 0.0 0.0  0.0 0.0 0.0
#&gt; D 0.0 0.0 0.2  1.0 0.0 0.0 0.0 -0.1 0.0 0.0
#&gt; E 0.0 0.0 0.0  0.0 1.0 0.2 0.0  0.0 0.0 0.0
#&gt; F 0.0 0.0 0.0  0.0 0.2 1.0 0.0  0.0 0.0 0.0
#&gt; G 0.0 0.0 0.0  0.0 0.0 0.0 1.0  0.3 0.0 0.0
#&gt; H 0.0 0.0 0.0 -0.1 0.0 0.0 0.3  1.0 0.0 0.0
#&gt; I 0.0 0.0 0.0  0.0 0.0 0.0 0.0  0.0 1.0 0.2
#&gt; J 0.0 0.0 0.0  0.0 0.0 0.0 0.0  0.0 0.2 1.0</div><div class='input'>
<span class='co'>## Can also return the precision matrix to see what happens</span>
<span class='co'>## m = 2 blocks, each "banded" with 4 off-diagonal bands</span>
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'>createS</span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>12</span>, <span class='st'>"banded"</span>, m <span class='op'>=</span> <span class='fl'>2</span>, banded.n <span class='op'>=</span> <span class='fl'>4</span>, precision <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, <span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      A    B    C    D    E    F    G    H    I    J    K    L
#&gt; A 1.00 0.50 0.33 0.25 0.20 0.00 0.00 0.00 0.00 0.00 0.00 0.00
#&gt; B 0.50 1.00 0.50 0.33 0.25 0.20 0.00 0.00 0.00 0.00 0.00 0.00
#&gt; C 0.33 0.50 1.00 0.50 0.33 0.25 0.00 0.00 0.00 0.00 0.00 0.00
#&gt; D 0.25 0.33 0.50 1.00 0.50 0.33 0.00 0.00 0.00 0.00 0.00 0.00
#&gt; E 0.20 0.25 0.33 0.50 1.00 0.50 0.00 0.00 0.00 0.00 0.00 0.00
#&gt; F 0.00 0.20 0.25 0.33 0.50 1.00 0.00 0.00 0.00 0.00 0.00 0.00
#&gt; G 0.00 0.00 0.00 0.00 0.00 0.00 1.00 0.50 0.33 0.25 0.20 0.00
#&gt; H 0.00 0.00 0.00 0.00 0.00 0.00 0.50 1.00 0.50 0.33 0.25 0.20
#&gt; I 0.00 0.00 0.00 0.00 0.00 0.00 0.33 0.50 1.00 0.50 0.33 0.25
#&gt; J 0.00 0.00 0.00 0.00 0.00 0.00 0.25 0.33 0.50 1.00 0.50 0.33
#&gt; K 0.00 0.00 0.00 0.00 0.00 0.00 0.20 0.25 0.33 0.50 1.00 0.50
#&gt; L 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.20 0.25 0.33 0.50 1.00</div><div class='input'>
<span class='co'>## Simulation using graph-games</span>
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'>createS</span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>10</span>, <span class='st'>"small-world"</span>, precision <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, <span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      A    B    C    D    E    F    G    H    I    J
#&gt; A 1.00 0.25 0.25 0.00 0.00 0.00 0.00 0.00 0.25 0.25
#&gt; B 0.25 1.00 0.25 0.25 0.00 0.00 0.00 0.00 0.00 0.25
#&gt; C 0.25 0.25 1.00 0.25 0.25 0.00 0.00 0.00 0.00 0.00
#&gt; D 0.00 0.25 0.25 1.00 0.25 0.25 0.00 0.00 0.00 0.00
#&gt; E 0.00 0.00 0.25 0.25 1.00 0.25 0.25 0.00 0.00 0.00
#&gt; F 0.00 0.00 0.00 0.25 0.25 1.00 0.25 0.25 0.00 0.00
#&gt; G 0.00 0.00 0.00 0.00 0.25 0.25 1.00 0.25 0.25 0.00
#&gt; H 0.00 0.00 0.00 0.00 0.00 0.25 0.25 1.00 0.25 0.25
#&gt; I 0.25 0.00 0.00 0.00 0.00 0.00 0.25 0.25 1.00 0.25
#&gt; J 0.25 0.25 0.00 0.00 0.00 0.00 0.00 0.25 0.25 1.00</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'>createS</span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>5</span>, <span class='st'>"scale-free"</span>, precision <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, <span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      A    B    C    D    E
#&gt; A 1.00 0.25 0.25 0.00 0.00
#&gt; B 0.25 1.00 0.00 0.00 0.25
#&gt; C 0.25 0.00 1.00 0.25 0.00
#&gt; D 0.00 0.00 0.25 1.00 0.00
#&gt; E 0.00 0.25 0.00 0.00 1.00</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'>createS</span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>5</span>, <span class='st'>"random-graph"</span>, precision <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, <span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      A B    C    D    E
#&gt; A 1.00 0 0.00 0.25 0.00
#&gt; B 0.00 1 0.00 0.00 0.00
#&gt; C 0.00 0 1.00 0.00 0.25
#&gt; D 0.25 0 0.00 1.00 0.00
#&gt; E 0.00 0 0.25 0.00 1.00</div><div class='input'>
<span class='co'>## Simulation using inverse Wishart distributed class covariance</span>
<span class='co'>## Low class homogeneity</span>
<span class='fu'>createS</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>10</span><span class='op'>)</span>, p <span class='op'>=</span> <span class='fl'>5</span>, <span class='st'>"banded"</span>, invwishart <span class='op'>=</span> <span class='cn'>TRUE</span>, nu <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $class1
#&gt;            A           B            C           D            E
#&gt; A  0.3407703 -0.15905885 -0.252470276  0.28600211 -0.468624961
#&gt; B -0.1590589  0.73069749 -0.348215530  0.06845775  1.042960473
#&gt; C -0.2524703 -0.34821553  0.942682156 -0.61086235 -0.007764689
#&gt; D  0.2860021  0.06845775 -0.610862347  1.10894996 -0.887920766
#&gt; E -0.4686250  1.04296047 -0.007764689 -0.88792077  2.846779236
#&gt; 
#&gt; $class2
#&gt;            A          B          C          D          E
#&gt; A  0.8862115  0.3589084 -0.1860808  0.4253942  0.4074453
#&gt; B  0.3589084  0.9585110 -0.1128333 -0.1451391  0.2661174
#&gt; C -0.1860808 -0.1128333  0.5340195 -0.2696945 -0.5983405
#&gt; D  0.4253942 -0.1451391 -0.2696945  0.7112546  0.4634702
#&gt; E  0.4074453  0.2661174 -0.5983405  0.4634702  0.9329733
#&gt; </div><div class='input'><span class='co'>## Extremely high class homogeneity</span>
<span class='fu'>createS</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>10</span><span class='op'>)</span>, p <span class='op'>=</span> <span class='fl'>5</span>, <span class='st'>"banded"</span>, invwishart <span class='op'>=</span> <span class='cn'>TRUE</span>, nu <span class='op'>=</span> <span class='fl'>1e10</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $class1
#&gt;             A          B           C          D           E
#&gt; A  0.95869737 -0.3809540  0.02415766  0.1725129 -0.54093975
#&gt; B -0.38095403  1.3124689  0.29900232 -1.2067459  0.57232835
#&gt; C  0.02415766  0.2990023  2.04928194 -0.3400434 -0.07280502
#&gt; D  0.17251292 -1.2067459 -0.34004344  2.1347086 -1.04191852
#&gt; E -0.54093975  0.5723283 -0.07280502 -1.0419185  1.57782754
#&gt; 
#&gt; $class2
#&gt;             A           B          C            D            E
#&gt; A  0.53744832 -0.03487138  0.1114366  0.256137126  0.118536460
#&gt; B -0.03487138  1.50640587 -1.2125845 -0.432946266  0.775990246
#&gt; C  0.11143658 -1.21258451  2.5358652 -0.116654635 -1.278033424
#&gt; D  0.25613713 -0.43294627 -0.1166546  0.633726286  0.001914981
#&gt; E  0.11853646  0.77599025 -1.2780334  0.001914981  1.631697726
#&gt; </div><div class='input'>
<span class='co'># The precision argument can again be used to see the actual realised class</span>
<span class='co'># precision matrices used when invwishart = TRUE.</span>

<span class='co'># The Plist argument is used to reuse old precision matrices or</span>
<span class='co'># user-generated ones</span>
<span class='va'>P</span> <span class='op'>&lt;-</span> <span class='fu'>createS</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>1</span>, p <span class='op'>=</span> <span class='fl'>5</span>, <span class='st'>"banded"</span>, precision <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'>createS</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1e5</span>, <span class='fl'>1e5</span><span class='op'>)</span>, p <span class='op'>=</span> <span class='fl'>5</span>, Plist <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>P</span>, <span class='va'>P</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>, <span class='va'>solve</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $class1
#&gt;              A            B         C            D            E
#&gt; A  1.003376159  0.503060389 0.3339784 -0.002151475 -0.001472794
#&gt; B  0.503060389  0.994602675 0.4989885  0.323371776 -0.002491459
#&gt; C  0.333978381  0.498988513 1.0010289  0.496668132  0.333095351
#&gt; D -0.002151475  0.323371776 0.4966681  0.995563778  0.502545053
#&gt; E -0.001472794 -0.002491459 0.3330954  0.502545053  1.003209189
#&gt; 
#&gt; $class2
#&gt;          A        B        C        D        E
#&gt; A 1.995161 1.495985 1.323942 1.000188 1.002387
#&gt; B 1.495985 1.996956 1.490973 1.334418 0.997494
#&gt; C 1.323942 1.490973 1.982567 1.495479 1.329760
#&gt; D 1.000188 1.334418 1.495479 2.005061 1.500588
#&gt; E 1.002387 0.997494 1.329760 1.500588 2.000471
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Carel F.W. Peeters, Anders Ellern Bilgrau, Wessel N. van Wieringen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


